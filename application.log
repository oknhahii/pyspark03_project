2024-02-21 15:48:02,495 - root -INFO -i am the main method
2024-02-21 15:48:02,495 - root -INFO -calling spark object
2024-02-21 15:48:02,495 - Create_spark -INFO -master is local[*]
2024-02-21 15:48:06,918 - Create_spark -INFO -Spark object created.....
2024-02-21 15:48:06,918 - root -INFO -Spark object is created!
2024-02-21 15:48:06,918 - root -INFO -Validating spark object
2024-02-21 15:48:06,918 - Validate -WARNING -started the get_current_date method...
2024-02-21 15:48:10,435 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 15:48:10,435 - Validate -WARNING -Validation done , go frwd...
2024-02-21 15:48:10,436 - root -INFO -reading file which is of > csv
2024-02-21 15:48:10,436 - Ingest -WARNING -load_files method started
2024-02-21 15:48:13,376 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:48:14,580 - root -INFO -Number of records of city table is 550068 
2024-02-21 15:48:14,580 - root -INFO -reading file which is of > parquet
2024-02-21 15:48:14,580 - Ingest -WARNING -load_files method started
2024-02-21 15:48:15,145 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:48:15,921 - root -INFO -Number of records of city table is 28338 
2024-02-21 15:48:31,411 - root -INFO -i am the main method
2024-02-21 15:48:31,411 - root -INFO -calling spark object
2024-02-21 15:48:31,411 - Create_spark -INFO -master is local[*]
2024-02-21 15:48:35,604 - Create_spark -INFO -Spark object created.....
2024-02-21 15:48:35,604 - root -INFO -Spark object is created!
2024-02-21 15:48:35,604 - root -INFO -Validating spark object
2024-02-21 15:48:35,604 - Validate -WARNING -started the get_current_date method...
2024-02-21 15:48:39,101 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 15:48:39,101 - Validate -WARNING -Validation done , go frwd...
2024-02-21 15:48:39,103 - root -INFO -reading file which is of > csv
2024-02-21 15:48:39,103 - Ingest -WARNING -load_files method started
2024-02-21 15:48:41,753 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:48:43,120 - root -INFO -reading file which is of > parquet
2024-02-21 15:48:43,120 - Ingest -WARNING -load_files method started
2024-02-21 15:48:43,543 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:49:44,052 - root -INFO -i am the main method
2024-02-21 15:49:44,052 - root -INFO -calling spark object
2024-02-21 15:49:44,052 - Create_spark -INFO -master is local[*]
2024-02-21 15:49:48,177 - Create_spark -INFO -Spark object created.....
2024-02-21 15:49:48,177 - root -INFO -Spark object is created!
2024-02-21 15:49:48,177 - root -INFO -Validating spark object
2024-02-21 15:49:48,177 - Validate -WARNING -started the get_current_date method...
2024-02-21 15:49:51,699 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 15:49:51,699 - Validate -WARNING -Validation done , go frwd...
2024-02-21 15:49:51,699 - root -INFO -reading file which is of > csv
2024-02-21 15:49:51,699 - Ingest -WARNING -load_files method started
2024-02-21 15:49:54,465 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:49:55,775 - Ingest -WARNING -Number of records of city table is 550068 
2024-02-21 15:49:55,775 - root -INFO -reading file which is of > parquet
2024-02-21 15:49:55,775 - Ingest -WARNING -load_files method started
2024-02-21 15:49:56,196 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:49:56,909 - Ingest -WARNING -Number of records of city table is 28338 
2024-02-21 15:53:54,227 - root -INFO -i am the main method
2024-02-21 15:53:54,227 - root -INFO -calling spark object
2024-02-21 15:53:54,227 - Create_spark -INFO -master is local[*]
2024-02-21 15:53:58,758 - Create_spark -INFO -Spark object created.....
2024-02-21 15:53:58,758 - root -INFO -Spark object is created!
2024-02-21 15:53:58,758 - root -INFO -Validating spark object
2024-02-21 15:53:58,758 - Validate -WARNING -started the get_current_date method...
2024-02-21 15:54:02,916 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 15:54:02,916 - Validate -WARNING -Validation done , go frwd...
2024-02-21 15:54:02,916 - root -INFO -reading file which is of > csv
2024-02-21 15:54:02,916 - Ingest -WARNING -load_files method started
2024-02-21 15:54:03,176 - Ingest -ERROR -An error occurred while dealing with load_file ====[PATH_NOT_FOUND] Path does not exist: file:/E:/Code/PysparkPro/source/oltp/dataset.csv.
2024-02-21 15:55:18,229 - root -INFO -i am the main method
2024-02-21 15:55:18,229 - root -INFO -calling spark object
2024-02-21 15:55:18,229 - Create_spark -INFO -master is local[*]
2024-02-21 15:55:22,797 - Create_spark -INFO -Spark object created.....
2024-02-21 15:55:22,797 - root -INFO -Spark object is created!
2024-02-21 15:55:22,797 - root -INFO -Validating spark object
2024-02-21 15:55:22,797 - Validate -WARNING -started the get_current_date method...
2024-02-21 15:55:26,742 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 15:55:26,742 - Validate -WARNING -Validation done , go frwd...
2024-02-21 15:55:26,743 - root -INFO -reading file which is of > csv
2024-02-21 15:55:26,743 - Ingest -WARNING -load_files method started
2024-02-21 15:55:30,829 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 15:55:32,286 - root -INFO -Number of records of city table is 1329329 
2024-02-21 19:39:38,827 - root -INFO -calling spark object
2024-02-21 19:39:38,828 - Create_spark -INFO -master is local[*]
2024-02-21 19:39:55,939 - Create_spark -INFO -Spark object created.....
2024-02-21 19:39:55,939 - root -INFO -Spark object is created!
2024-02-21 19:39:55,939 - root -INFO -Validating spark object
2024-02-21 19:39:55,939 - Validate -WARNING -started the get_current_date method...
2024-02-21 19:40:02,888 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 19:40:02,888 - Validate -WARNING -Validation done , go frwd...
2024-02-21 19:40:02,888 - root -INFO -reading file which is of > csv
2024-02-21 19:40:02,888 - Ingest -WARNING -load_files method started
2024-02-21 19:40:11,063 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 19:40:14,283 - root -INFO -Number of records of city table is 1329329 
2024-02-21 22:47:43,199 - root -INFO -calling spark object
2024-02-21 22:47:43,200 - Create_spark -INFO -master is local[*]
2024-02-21 22:47:54,182 - Create_spark -INFO -Spark object created.....
2024-02-21 22:47:54,182 - root -INFO -Spark object is created!
2024-02-21 22:47:54,182 - root -INFO -Validating spark object
2024-02-21 22:47:54,182 - Validate -WARNING -started the get_current_date method...
2024-02-21 22:47:58,587 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 22:47:58,587 - Validate -WARNING -Validation done , go frwd...
2024-02-21 22:47:58,587 - root -INFO -reading file which is of > csv
2024-02-21 22:47:58,587 - Ingest -WARNING -load_files method started
2024-02-21 22:48:02,270 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 22:48:03,631 - root -INFO -Number of records of city table is 1329329 
2024-02-21 23:13:41,558 - root -INFO -calling spark object
2024-02-21 23:13:41,559 - Create_spark -INFO -master is local[*]
2024-02-21 23:13:47,225 - Create_spark -INFO -Spark object created.....
2024-02-21 23:13:47,225 - root -INFO -Spark object is created!
2024-02-21 23:13:47,225 - root -INFO -Validating spark object
2024-02-21 23:13:47,225 - Validate -WARNING -started the get_current_date method...
2024-02-21 23:13:51,841 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 23:13:51,841 - Validate -WARNING -Validation done , go frwd...
2024-02-21 23:13:51,841 - root -INFO -Get file info from olap src
2024-02-21 23:13:51,841 - root -INFO -reading file which is of > parquet
2024-02-21 23:13:51,841 - root -INFO -Load the cities data
2024-02-21 23:13:51,842 - Ingest -WARNING -load_files method started
2024-02-21 23:13:52,610 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 23:13:55,346 - root -INFO -Number of records of city table is 28338 
2024-02-21 23:16:55,428 - root -INFO -calling spark object
2024-02-21 23:16:55,429 - Create_spark -INFO -master is local[*]
2024-02-21 23:16:59,708 - Create_spark -INFO -Spark object created.....
2024-02-21 23:16:59,708 - root -INFO -Spark object is created!
2024-02-21 23:16:59,708 - root -INFO -Validating spark object
2024-02-21 23:16:59,708 - Validate -WARNING -started the get_current_date method...
2024-02-21 23:17:03,413 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 23:17:03,413 - Validate -WARNING -Validation done , go frwd...
2024-02-21 23:17:03,413 - root -INFO -Get file info from olap src
2024-02-21 23:17:03,413 - root -INFO -reading file which is of > parquet
2024-02-21 23:17:03,413 - root -INFO -Load the cities data
2024-02-21 23:17:03,413 - Ingest -WARNING -load_files method started
2024-02-21 23:17:04,025 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 23:17:06,179 - root -INFO -Number of records of city table is 28338 
2024-02-21 23:17:06,179 - root -INFO -Get the file info from oltp src
2024-02-21 23:17:06,179 - root -INFO -reading file which is of > csv
2024-02-21 23:17:06,179 - root -INFO -Load the presc medicare data
2024-02-21 23:17:06,179 - Ingest -WARNING -load_files method started
2024-02-21 23:17:08,344 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 23:17:09,328 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-21 23:20:34,051 - root -INFO -calling spark object
2024-02-21 23:20:34,051 - Create_spark -INFO -master is local[*]
2024-02-21 23:20:39,261 - Create_spark -INFO -Spark object created.....
2024-02-21 23:20:39,261 - root -INFO -Spark object is created!
2024-02-21 23:20:39,261 - root -INFO -Validating spark object
2024-02-21 23:20:39,262 - Validate -WARNING -started the get_current_date method...
2024-02-21 23:20:43,635 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 21))]
2024-02-21 23:20:43,635 - Validate -WARNING -Validation done , go frwd...
2024-02-21 23:20:43,635 - root -INFO -Get file info from olap src
2024-02-21 23:20:43,635 - root -INFO -reading file which is of > parquet
2024-02-21 23:20:43,635 - root -INFO -Load the cities data
2024-02-21 23:20:43,635 - Ingest -WARNING -load_files method started
2024-02-21 23:20:44,243 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 23:20:46,740 - root -INFO -Number of records of city table is 28338 
2024-02-21 23:20:46,740 - root -INFO -Get the file info from oltp src
2024-02-21 23:20:46,740 - root -INFO -reading file which is of > csv
2024-02-21 23:20:46,740 - root -INFO -Load the presc medicare data
2024-02-21 23:20:46,740 - Ingest -WARNING -load_files method started
2024-02-21 23:20:49,384 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-21 23:20:50,760 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-21 23:20:50,760 - Data_processing -WARNING -data_clean method() started...
2024-02-21 23:20:50,760 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-21 23:20:50,809 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-21 23:20:50,832 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-21 23:20:50,843 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-21 23:20:50,881 - Data_processing -WARNING -concat first and lname 
2024-02-21 23:20:50,901 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-21 23:20:50,912 - Data_processing -WARNING -now check for null values in all columns
2024-02-21 23:20:50,912 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-21 23:20:50,932 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-21 23:20:52,462 - Data_processing -WARNING -successfully droped the null values....
2024-02-21 23:20:52,462 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-21 23:20:52,462 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 05:56:51,841 - root -INFO -calling spark object
2024-02-22 05:56:51,841 - Create_spark -INFO -master is local[*]
2024-02-22 05:56:57,976 - Create_spark -INFO -Spark object created.....
2024-02-22 05:56:57,976 - root -INFO -Spark object is created!
2024-02-22 05:56:57,976 - root -INFO -Validating spark object
2024-02-22 05:56:57,977 - Validate -WARNING -started the get_current_date method...
2024-02-22 05:57:02,784 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 05:57:02,785 - Validate -WARNING -Validation done , go frwd...
2024-02-22 05:57:02,785 - root -INFO -Get file info from olap src
2024-02-22 05:57:02,785 - root -INFO -reading file which is of > parquet
2024-02-22 05:57:02,785 - root -INFO -Load the cities data
2024-02-22 05:57:02,786 - Ingest -WARNING -load_files method started
2024-02-22 05:57:03,614 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 05:57:06,800 - root -INFO -Number of records of city table is 28338 
2024-02-22 05:57:06,801 - root -INFO -Get the file info from oltp src
2024-02-22 05:57:06,801 - root -INFO -reading file which is of > csv
2024-02-22 05:57:06,801 - root -INFO -Load the presc medicare data
2024-02-22 05:57:06,801 - Ingest -WARNING -load_files method started
2024-02-22 05:57:09,642 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 05:57:10,681 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 05:57:10,681 - Data_processing -WARNING -data_clean method() started...
2024-02-22 05:57:10,681 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 05:57:10,775 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 05:57:10,825 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 05:57:10,845 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 05:57:10,906 - Data_processing -WARNING -concat first and lname 
2024-02-22 05:57:10,936 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 05:57:10,947 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 05:57:10,947 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 05:57:10,969 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 05:57:12,560 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 05:57:12,560 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 05:57:12,560 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 05:58:32,593 - root -INFO -calling spark object
2024-02-22 05:58:32,593 - Create_spark -INFO -master is local[*]
2024-02-22 05:58:38,657 - Create_spark -INFO -Spark object created.....
2024-02-22 05:58:38,657 - root -INFO -Spark object is created!
2024-02-22 05:58:38,657 - root -INFO -Validating spark object
2024-02-22 05:58:38,657 - Validate -WARNING -started the get_current_date method...
2024-02-22 05:58:43,796 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 05:58:43,796 - Validate -WARNING -Validation done , go frwd...
2024-02-22 05:58:43,796 - root -INFO -Get file info from olap src
2024-02-22 05:58:43,796 - root -INFO -reading file which is of > parquet
2024-02-22 05:58:43,797 - root -INFO -Load the cities data
2024-02-22 05:58:43,797 - Ingest -WARNING -load_files method started
2024-02-22 05:58:44,567 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 05:58:48,055 - root -INFO -Number of records of city table is 28338 
2024-02-22 05:58:48,055 - root -INFO -Get the file info from oltp src
2024-02-22 05:58:48,055 - root -INFO -reading file which is of > csv
2024-02-22 05:58:48,055 - root -INFO -Load the presc medicare data
2024-02-22 05:58:48,055 - Ingest -WARNING -load_files method started
2024-02-22 05:58:51,031 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 05:58:52,406 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 05:58:52,406 - Data_processing -WARNING -data_clean method() started...
2024-02-22 05:58:52,406 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 05:58:52,505 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 05:58:52,560 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 05:58:52,585 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 05:58:52,670 - Data_processing -WARNING -concat first and lname 
2024-02-22 05:58:52,707 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 05:58:52,722 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 05:58:52,722 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 05:58:52,753 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 05:58:54,079 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 05:58:54,079 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 05:58:54,079 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 05:58:54,487 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 05:58:54,489 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 05:58:54,489 - Validate -INFO -print_schema done, go ....
2024-02-22 05:58:54,489 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 05:58:54,491 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 05:58:54,491 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 05:58:54,491 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 05:58:54,491 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 05:58:54,491 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 05:58:54,491 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 05:58:54,491 - Validate -INFO -print_schema done, go ....
2024-02-22 06:10:11,811 - root -INFO -calling spark object
2024-02-22 06:10:11,811 - Create_spark -INFO -master is local[*]
2024-02-22 06:10:16,847 - Create_spark -INFO -Spark object created.....
2024-02-22 06:10:16,847 - root -INFO -Spark object is created!
2024-02-22 06:10:16,847 - root -INFO -Validating spark object
2024-02-22 06:10:16,847 - Validate -WARNING -started the get_current_date method...
2024-02-22 06:10:21,362 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 06:10:21,362 - Validate -WARNING -Validation done , go frwd...
2024-02-22 06:10:21,363 - root -INFO -Get file info from olap src
2024-02-22 06:10:21,363 - root -INFO -reading file which is of > parquet
2024-02-22 06:10:21,363 - root -INFO -Load the cities data
2024-02-22 06:10:21,363 - Ingest -WARNING -load_files method started
2024-02-22 06:10:21,967 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 06:10:24,440 - root -INFO -Number of records of city table is 28338 
2024-02-22 06:10:24,440 - root -INFO -Get the file info from oltp src
2024-02-22 06:10:24,441 - root -INFO -reading file which is of > csv
2024-02-22 06:10:24,441 - root -INFO -Load the presc medicare data
2024-02-22 06:10:24,441 - Ingest -WARNING -load_files method started
2024-02-22 06:10:26,658 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 06:10:27,482 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 06:10:27,482 - Data_processing -WARNING -data_clean method() started...
2024-02-22 06:10:27,482 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 06:10:27,531 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 06:10:27,562 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 06:10:27,577 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 06:10:27,626 - Data_processing -WARNING -concat first and last name 
2024-02-22 06:10:27,646 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 06:10:27,655 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 06:10:27,655 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 06:10:27,680 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 06:10:28,725 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 06:10:28,725 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 06:10:28,725 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 06:10:29,120 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 06:10:29,122 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 06:10:29,122 - Validate -INFO -print_schema done, go ....
2024-02-22 06:10:29,123 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 06:10:29,124 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 06:10:29,124 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 06:10:29,124 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 06:10:29,125 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 06:10:29,125 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 06:10:29,125 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 06:10:29,125 - Validate -INFO -print_schema done, go ....
2024-02-22 14:46:51,953 - root -INFO -calling spark object
2024-02-22 14:46:51,954 - Create_spark -INFO -master is local[*]
2024-02-22 14:47:05,740 - Create_spark -INFO -Spark object created.....
2024-02-22 14:47:05,741 - root -INFO -Spark object is created!
2024-02-22 14:47:05,741 - root -INFO -Validating spark object
2024-02-22 14:47:05,741 - Validate -WARNING -started the get_current_date method...
2024-02-22 14:47:10,879 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 14:47:10,879 - Validate -WARNING -Validation done , go frwd...
2024-02-22 14:47:10,879 - root -INFO -Get file info from olap src
2024-02-22 14:47:10,879 - root -INFO -reading file which is of > parquet
2024-02-22 14:47:10,879 - root -INFO -Load the cities data
2024-02-22 14:47:10,879 - Ingest -WARNING -load_files method started
2024-02-22 14:47:11,712 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 14:47:15,087 - root -INFO -Number of records of city table is 28338 
2024-02-22 14:47:15,087 - root -INFO -Get the file info from oltp src
2024-02-22 14:47:15,088 - root -INFO -reading file which is of > csv
2024-02-22 14:47:15,088 - root -INFO -Load the presc medicare data
2024-02-22 14:47:15,088 - Ingest -WARNING -load_files method started
2024-02-22 14:47:17,841 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 14:47:18,812 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 14:47:18,812 - Data_processing -WARNING -data_clean method() started...
2024-02-22 14:47:18,812 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 14:47:18,872 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 14:47:18,915 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 14:47:18,938 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 14:47:19,026 - Data_processing -WARNING -concat first and last name 
2024-02-22 14:47:19,063 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 14:47:19,077 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 14:47:19,077 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 14:47:19,105 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 14:47:20,368 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 14:47:20,368 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 14:47:20,368 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 14:47:20,830 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 14:47:20,833 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 14:47:20,833 - Validate -INFO -print_schema done, go ....
2024-02-22 14:47:20,833 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 14:47:20,835 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 14:47:20,835 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 14:47:20,835 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 14:47:20,835 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 14:47:20,835 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 14:47:20,835 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 14:47:20,835 - Validate -INFO -print_schema done, go ....
2024-02-22 15:12:03,678 - root -INFO -calling spark object
2024-02-22 15:12:03,679 - Create_spark -INFO -master is local[*]
2024-02-22 15:12:09,539 - Create_spark -INFO -Spark object created.....
2024-02-22 15:12:09,539 - root -INFO -Spark object is created!
2024-02-22 15:12:09,539 - root -INFO -Validating spark object
2024-02-22 15:12:09,539 - Validate -WARNING -started the get_current_date method...
2024-02-22 15:12:14,334 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 15:12:14,334 - Validate -WARNING -Validation done , go frwd...
2024-02-22 15:12:14,335 - root -INFO -Get file info from olap src
2024-02-22 15:12:14,335 - root -INFO -reading file which is of > parquet
2024-02-22 15:12:14,335 - root -INFO -Load the cities data
2024-02-22 15:12:14,335 - Ingest -WARNING -load_files method started
2024-02-22 15:12:15,086 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:12:17,930 - root -INFO -Number of records of city table is 28338 
2024-02-22 15:12:17,930 - root -INFO -Get the file info from oltp src
2024-02-22 15:12:17,930 - root -INFO -reading file which is of > csv
2024-02-22 15:12:17,930 - root -INFO -Load the presc medicare data
2024-02-22 15:12:17,930 - Ingest -WARNING -load_files method started
2024-02-22 15:12:21,075 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:12:22,739 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 15:12:22,739 - Data_processing -WARNING -data_clean method() started...
2024-02-22 15:12:22,741 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 15:12:22,830 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 15:12:22,869 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 15:12:22,889 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 15:12:22,942 - Data_processing -WARNING -concat first and last name 
2024-02-22 15:12:22,960 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 15:12:22,968 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 15:12:22,968 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 15:12:22,987 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 15:12:24,265 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 15:12:24,265 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 15:12:24,265 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 15:12:24,605 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 15:12:24,606 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 15:12:24,606 - Validate -INFO -print_schema done, go ....
2024-02-22 15:12:24,606 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 15:12:24,608 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 15:12:24,608 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 15:12:24,608 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 15:12:24,608 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 15:12:24,608 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 15:12:24,608 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 15:12:24,608 - Validate -INFO -print_schema done, go ....
2024-02-22 15:12:24,608 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 15:12:24,757 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 15:12:47,583 - root -INFO -calling spark object
2024-02-22 15:12:47,583 - Create_spark -INFO -master is local[*]
2024-02-22 15:12:52,882 - Create_spark -INFO -Spark object created.....
2024-02-22 15:12:52,882 - root -INFO -Spark object is created!
2024-02-22 15:12:52,882 - root -INFO -Validating spark object
2024-02-22 15:12:52,882 - Validate -WARNING -started the get_current_date method...
2024-02-22 15:12:57,785 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 15:12:57,785 - Validate -WARNING -Validation done , go frwd...
2024-02-22 15:12:57,785 - root -INFO -Get file info from olap src
2024-02-22 15:12:57,786 - root -INFO -reading file which is of > parquet
2024-02-22 15:12:57,786 - root -INFO -Load the cities data
2024-02-22 15:12:57,786 - Ingest -WARNING -load_files method started
2024-02-22 15:12:58,600 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:13:01,424 - root -INFO -Number of records of city table is 28338 
2024-02-22 15:13:01,424 - root -INFO -Get the file info from oltp src
2024-02-22 15:13:01,425 - root -INFO -reading file which is of > csv
2024-02-22 15:13:01,425 - root -INFO -Load the presc medicare data
2024-02-22 15:13:01,425 - Ingest -WARNING -load_files method started
2024-02-22 15:13:04,303 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:13:05,527 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 15:13:05,527 - Data_processing -WARNING -data_clean method() started...
2024-02-22 15:13:05,527 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 15:13:05,632 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 15:13:05,685 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 15:13:05,706 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 15:13:05,762 - Data_processing -WARNING -concat first and last name 
2024-02-22 15:13:05,785 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 15:13:05,796 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 15:13:05,796 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 15:13:05,818 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 15:13:07,095 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 15:13:07,096 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 15:13:07,096 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 15:13:07,628 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 15:13:07,629 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 15:13:07,629 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 15:13:07,629 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 15:13:07,629 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 15:13:07,631 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 15:13:07,631 - Validate -INFO -print_schema done, go ....
2024-02-22 15:13:07,631 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 15:13:07,632 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 15:13:07,632 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 15:13:07,632 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 15:13:07,632 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 15:13:07,632 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 15:13:07,632 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 15:13:07,632 - Validate -INFO -print_schema done, go ....
2024-02-22 15:13:07,632 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 15:13:07,798 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 15:14:08,878 - root -INFO -calling spark object
2024-02-22 15:14:08,878 - Create_spark -INFO -master is local[*]
2024-02-22 15:14:14,625 - Create_spark -INFO -Spark object created.....
2024-02-22 15:14:14,626 - root -INFO -Spark object is created!
2024-02-22 15:14:14,626 - root -INFO -Validating spark object
2024-02-22 15:14:14,626 - Validate -WARNING -started the get_current_date method...
2024-02-22 15:14:19,507 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 15:14:19,507 - Validate -WARNING -Validation done , go frwd...
2024-02-22 15:14:19,507 - root -INFO -Get file info from olap src
2024-02-22 15:14:19,507 - root -INFO -reading file which is of > parquet
2024-02-22 15:14:19,507 - root -INFO -Load the cities data
2024-02-22 15:14:19,507 - Ingest -WARNING -load_files method started
2024-02-22 15:14:20,361 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:14:23,701 - root -INFO -Number of records of city table is 28338 
2024-02-22 15:14:23,702 - root -INFO -Get the file info from oltp src
2024-02-22 15:14:23,702 - root -INFO -reading file which is of > csv
2024-02-22 15:14:23,702 - root -INFO -Load the presc medicare data
2024-02-22 15:14:23,702 - Ingest -WARNING -load_files method started
2024-02-22 15:14:26,761 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:14:27,730 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 15:14:27,731 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 15:14:28,013 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 15:14:28,955 - root -INFO -Cleaning the two dataframe!
2024-02-22 15:14:28,955 - Data_processing -WARNING -data_clean method() started...
2024-02-22 15:14:28,955 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 15:14:28,990 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 15:14:29,014 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 15:14:29,025 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 15:14:29,083 - Data_processing -WARNING -concat first and last name 
2024-02-22 15:14:29,109 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 15:14:29,118 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 15:14:29,118 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 15:14:29,141 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 15:14:30,227 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 15:14:30,227 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 15:14:30,227 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 15:14:30,600 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 15:14:30,601 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 15:14:30,601 - Validate -INFO -print_schema done, go ....
2024-02-22 15:14:30,602 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 15:14:30,602 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 15:14:30,603 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 15:14:30,603 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 15:14:30,603 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 15:14:30,603 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 15:14:30,603 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 15:14:30,603 - Validate -INFO -print_schema done, go ....
2024-02-22 15:14:41,978 - root -INFO -calling spark object
2024-02-22 15:14:41,978 - Create_spark -INFO -master is local[*]
2024-02-22 15:14:47,381 - Create_spark -INFO -Spark object created.....
2024-02-22 15:14:47,381 - root -INFO -Spark object is created!
2024-02-22 15:14:47,381 - root -INFO -Validating spark object
2024-02-22 15:14:47,381 - Validate -WARNING -started the get_current_date method...
2024-02-22 15:14:51,791 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 15:14:51,792 - Validate -WARNING -Validation done , go frwd...
2024-02-22 15:14:51,792 - root -INFO -Get file info from olap src
2024-02-22 15:14:51,792 - root -INFO -reading file which is of > parquet
2024-02-22 15:14:51,792 - root -INFO -Load the cities data
2024-02-22 15:14:51,792 - Ingest -WARNING -load_files method started
2024-02-22 15:14:52,434 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:14:54,972 - root -INFO -Number of records of city table is 28338 
2024-02-22 15:14:54,972 - root -INFO -Get the file info from oltp src
2024-02-22 15:14:54,973 - root -INFO -reading file which is of > csv
2024-02-22 15:14:54,973 - root -INFO -Load the presc medicare data
2024-02-22 15:14:54,973 - Ingest -WARNING -load_files method started
2024-02-22 15:14:57,545 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:14:58,286 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 15:14:58,286 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 15:14:58,590 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 15:15:05,861 - root -INFO -Cleaning the two dataframe!
2024-02-22 15:15:05,861 - Data_processing -WARNING -data_clean method() started...
2024-02-22 15:15:05,861 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 15:15:05,890 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 15:15:05,908 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 15:15:05,921 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 15:15:05,968 - Data_processing -WARNING -concat first and last name 
2024-02-22 15:15:05,987 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 15:15:05,995 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 15:15:05,996 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 15:15:06,012 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 15:15:06,992 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 15:15:06,992 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 15:15:06,992 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 15:15:07,305 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 15:15:07,308 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 15:15:07,308 - Validate -INFO -print_schema done, go ....
2024-02-22 15:15:07,308 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 15:15:07,310 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 15:15:07,310 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 15:15:07,310 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 15:15:07,311 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 15:15:07,311 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 15:15:07,311 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 15:15:07,311 - Validate -INFO -print_schema done, go ....
2024-02-22 15:54:56,959 - root -INFO -calling spark object
2024-02-22 15:54:56,959 - Create_spark -INFO -master is local[*]
2024-02-22 15:55:05,200 - Create_spark -INFO -Spark object created.....
2024-02-22 15:55:05,200 - root -INFO -Spark object is created!
2024-02-22 15:55:05,200 - root -INFO -Validating spark object
2024-02-22 15:55:05,200 - Validate -WARNING -started the get_current_date method...
2024-02-22 15:55:11,439 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 15:55:11,439 - Validate -WARNING -Validation done , go frwd...
2024-02-22 15:55:11,439 - root -INFO -Get file info from olap src
2024-02-22 15:55:11,439 - root -INFO -reading file which is of > parquet
2024-02-22 15:55:11,439 - root -INFO -Load the cities data
2024-02-22 15:55:11,439 - Ingest -WARNING -load_files method started
2024-02-22 15:55:12,497 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:55:16,015 - root -INFO -Number of records of city table is 28338 
2024-02-22 15:55:16,015 - root -INFO -Get the file info from oltp src
2024-02-22 15:55:16,022 - root -INFO -reading file which is of > csv
2024-02-22 15:55:16,022 - root -INFO -Load the presc medicare data
2024-02-22 15:55:16,022 - Ingest -WARNING -load_files method started
2024-02-22 15:55:18,476 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 15:55:19,843 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 15:55:19,843 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 15:55:19,843 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 15:55:20,313 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 15:55:28,152 - root -INFO -Cleaning the two dataframe!
2024-02-22 15:55:28,152 - Data_processing -WARNING -data_clean method() started...
2024-02-22 15:55:28,152 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 15:55:28,186 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 15:55:28,208 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 15:55:28,216 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 15:55:28,270 - Data_processing -WARNING -concat first and last name 
2024-02-22 15:55:28,295 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 15:55:28,304 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 15:55:28,304 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 15:55:28,326 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 15:55:29,332 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 15:55:29,332 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 15:55:29,332 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 15:55:29,684 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 15:55:29,686 - Validate -INFO -print_schema done, go ....
2024-02-22 15:55:29,686 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 15:55:29,686 - Validate -INFO -print_schema done, go ....
2024-02-22 15:55:29,686 - root -INFO -The app done
2024-02-22 22:09:40,406 - root -INFO -calling spark object
2024-02-22 22:09:40,406 - Create_spark -INFO -master is local[*]
2024-02-22 22:09:59,490 - Create_spark -INFO -Spark object created.....
2024-02-22 22:09:59,490 - root -INFO -Spark object is created!
2024-02-22 22:09:59,490 - root -INFO -Validating spark object
2024-02-22 22:09:59,491 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:10:05,949 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:10:05,949 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:10:05,949 - root -INFO -Get file info from olap src
2024-02-22 22:10:05,952 - root -INFO -reading file which is of > parquet
2024-02-22 22:10:05,952 - root -INFO -Load the cities data
2024-02-22 22:10:05,952 - Ingest -WARNING -load_files method started
2024-02-22 22:10:07,002 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:10:10,746 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:10:10,747 - root -INFO -Get the file info from oltp src
2024-02-22 22:10:10,748 - root -INFO -reading file which is of > csv
2024-02-22 22:10:10,748 - root -INFO -Load the presc medicare data
2024-02-22 22:10:10,748 - Ingest -WARNING -load_files method started
2024-02-22 22:10:14,588 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:10:15,941 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:10:15,942 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:10:15,942 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:10:16,453 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:10:25,522 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:10:25,522 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:10:25,522 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:10:25,554 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:10:25,572 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:10:25,584 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:10:25,642 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:10:25,668 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:10:25,682 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:10:25,682 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:10:25,705 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:10:27,293 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:10:27,294 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:10:27,294 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:10:27,912 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 22:10:27,914 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 22:10:27,914 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 22:10:27,914 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 22:10:27,914 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 22:10:27,914 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 22:10:27,915 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 22:10:27,915 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 22:10:27,915 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 22:10:27,915 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 22:10:27,915 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 22:10:27,915 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 22:10:27,915 - Validate -INFO -print_schema done, go ....
2024-02-22 22:10:27,915 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 22:10:27,917 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 22:10:27,918 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 22:10:27,918 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 22:10:27,918 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 22:10:27,918 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 22:10:27,918 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 22:10:27,918 - Validate -INFO -print_schema done, go ....
2024-02-22 22:10:27,918 - root -INFO -Showing the report 1!
2024-02-22 22:10:27,918 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 22:10:27,923 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 22:10:28,001 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 22:10:28,080 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 22:10:28,182 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 22:10:37,212 - root -INFO -Showing the report 2!
2024-02-22 22:10:37,212 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 22:10:37,485 - root -INFO -The app done
2024-02-22 22:14:31,462 - root -INFO -calling spark object
2024-02-22 22:14:31,463 - Create_spark -INFO -master is local[*]
2024-02-22 22:14:36,915 - Create_spark -INFO -Spark object created.....
2024-02-22 22:14:36,915 - root -INFO -Spark object is created!
2024-02-22 22:14:36,915 - root -INFO -Validating spark object
2024-02-22 22:14:36,915 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:14:42,497 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:14:42,497 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:14:42,497 - root -INFO -Get file info from olap src
2024-02-22 22:14:42,497 - root -INFO -reading file which is of > parquet
2024-02-22 22:14:42,497 - root -INFO -Load the cities data
2024-02-22 22:14:42,497 - Ingest -WARNING -load_files method started
2024-02-22 22:14:43,407 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:14:46,996 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:14:46,996 - root -INFO -Get the file info from oltp src
2024-02-22 22:14:46,996 - root -INFO -reading file which is of > csv
2024-02-22 22:14:46,997 - root -INFO -Load the presc medicare data
2024-02-22 22:14:46,997 - Ingest -WARNING -load_files method started
2024-02-22 22:14:49,923 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:14:50,957 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:14:50,958 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:14:50,958 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:14:51,406 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:15:00,456 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:15:00,456 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:15:00,456 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:15:00,492 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:15:00,515 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:15:00,527 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:15:00,570 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:15:00,598 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:15:00,609 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:15:00,609 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:15:00,634 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:15:02,161 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:15:02,163 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:15:02,163 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:15:02,607 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 22:15:02,609 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 22:15:02,610 - Validate -INFO -print_schema done, go ....
2024-02-22 22:15:02,610 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 22:15:02,612 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 22:15:02,612 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 22:15:02,612 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 22:15:02,612 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 22:15:02,612 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 22:15:02,612 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 22:15:02,612 - Validate -INFO -print_schema done, go ....
2024-02-22 22:15:02,612 - root -INFO -The app done
2024-02-22 22:15:55,088 - root -INFO -calling spark object
2024-02-22 22:15:55,088 - Create_spark -INFO -master is local[*]
2024-02-22 22:16:01,442 - Create_spark -INFO -Spark object created.....
2024-02-22 22:16:01,442 - root -INFO -Spark object is created!
2024-02-22 22:16:01,442 - root -INFO -Validating spark object
2024-02-22 22:16:01,442 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:16:06,275 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:16:06,276 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:16:06,276 - root -INFO -Get file info from olap src
2024-02-22 22:16:06,276 - root -INFO -reading file which is of > parquet
2024-02-22 22:16:06,276 - root -INFO -Load the cities data
2024-02-22 22:16:06,276 - Ingest -WARNING -load_files method started
2024-02-22 22:16:06,953 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:16:10,415 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:16:10,417 - root -INFO -Get the file info from oltp src
2024-02-22 22:16:10,417 - root -INFO -reading file which is of > csv
2024-02-22 22:16:10,417 - root -INFO -Load the presc medicare data
2024-02-22 22:16:10,417 - Ingest -WARNING -load_files method started
2024-02-22 22:16:13,468 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:16:14,531 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:16:14,531 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:16:14,531 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:16:15,196 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:16:24,671 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:16:24,671 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:16:24,671 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:16:24,713 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:16:24,746 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:16:24,764 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:16:24,819 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:16:24,848 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:16:24,861 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:16:24,861 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:16:24,887 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:16:26,203 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:16:26,204 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:16:26,204 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:16:26,204 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 22:16:26,205 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 22:16:26,205 - Validate -INFO -print_schema done, go ....
2024-02-22 22:16:26,205 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 22:16:26,208 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 22:16:26,208 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 22:16:26,208 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 22:16:26,208 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 22:16:26,208 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 22:16:26,208 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 22:16:26,208 - Validate -INFO -print_schema done, go ....
2024-02-22 22:16:26,208 - root -INFO -The app done
2024-02-22 22:20:37,055 - root -INFO -calling spark object
2024-02-22 22:20:37,055 - Create_spark -INFO -master is local[*]
2024-02-22 22:20:42,509 - Create_spark -INFO -Spark object created.....
2024-02-22 22:20:42,509 - root -INFO -Spark object is created!
2024-02-22 22:20:42,509 - root -INFO -Validating spark object
2024-02-22 22:20:42,509 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:20:47,238 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:20:47,238 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:20:47,238 - root -INFO -Get file info from olap src
2024-02-22 22:20:47,238 - root -INFO -reading file which is of > parquet
2024-02-22 22:20:47,238 - root -INFO -Load the cities data
2024-02-22 22:20:47,238 - Ingest -WARNING -load_files method started
2024-02-22 22:20:48,033 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:20:51,182 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:20:51,182 - root -INFO -Get the file info from oltp src
2024-02-22 22:20:51,182 - root -INFO -reading file which is of > csv
2024-02-22 22:20:51,182 - root -INFO -Load the presc medicare data
2024-02-22 22:20:51,182 - Ingest -WARNING -load_files method started
2024-02-22 22:20:54,728 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:20:55,778 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:20:55,779 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:20:55,779 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:20:56,333 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:21:04,821 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:21:04,821 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:21:04,821 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:21:04,855 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:21:04,875 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:21:04,886 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:21:04,924 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:21:04,943 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:21:04,955 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:21:04,955 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:21:04,977 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:21:06,566 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:21:06,567 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:21:06,567 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:21:06,567 - root -INFO -Showing the report 2!
2024-02-22 22:21:06,567 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 22:21:06,815 - root -INFO -The app done
2024-02-22 22:22:47,353 - root -INFO -calling spark object
2024-02-22 22:22:47,353 - Create_spark -INFO -master is local[*]
2024-02-22 22:22:53,648 - Create_spark -INFO -Spark object created.....
2024-02-22 22:22:53,648 - root -INFO -Spark object is created!
2024-02-22 22:22:53,650 - root -INFO -Validating spark object
2024-02-22 22:22:53,650 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:22:59,590 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:22:59,590 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:22:59,590 - root -INFO -Get file info from olap src
2024-02-22 22:22:59,591 - root -INFO -reading file which is of > parquet
2024-02-22 22:22:59,591 - root -INFO -Load the cities data
2024-02-22 22:22:59,591 - Ingest -WARNING -load_files method started
2024-02-22 22:23:00,429 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:23:03,929 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:23:03,929 - root -INFO -Get the file info from oltp src
2024-02-22 22:23:03,930 - root -INFO -reading file which is of > csv
2024-02-22 22:23:03,930 - root -INFO -Load the presc medicare data
2024-02-22 22:23:03,930 - Ingest -WARNING -load_files method started
2024-02-22 22:23:06,727 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:23:08,097 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:23:08,097 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:23:08,097 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:23:08,570 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:23:17,553 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:23:17,553 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:23:17,553 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:23:17,598 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:23:17,628 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:23:17,646 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:23:17,730 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:23:17,766 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:23:17,782 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:23:17,782 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:23:17,819 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:23:19,246 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:23:19,246 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:23:19,246 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:23:19,501 - root -INFO -Showing the report 2!
2024-02-22 22:23:19,502 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 22:23:19,663 - root -INFO -The app done
2024-02-22 22:57:17,446 - root -INFO -calling spark object
2024-02-22 22:57:17,446 - Create_spark -INFO -master is local[*]
2024-02-22 22:57:25,357 - Create_spark -INFO -Spark object created.....
2024-02-22 22:57:25,357 - root -INFO -Spark object is created!
2024-02-22 22:57:25,357 - root -INFO -Validating spark object
2024-02-22 22:57:25,357 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:57:31,600 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:57:31,600 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:57:31,600 - root -INFO -Get file info from olap src
2024-02-22 22:57:31,602 - root -INFO -reading file which is of > parquet
2024-02-22 22:57:31,602 - root -INFO -Load the cities data
2024-02-22 22:57:31,602 - Ingest -WARNING -load_files method started
2024-02-22 22:57:32,555 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:57:36,227 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:57:36,227 - root -INFO -Get the file info from oltp src
2024-02-22 22:57:36,229 - root -INFO -reading file which is of > csv
2024-02-22 22:57:36,229 - root -INFO -Load the presc medicare data
2024-02-22 22:57:36,229 - Ingest -WARNING -load_files method started
2024-02-22 22:57:42,904 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:57:45,208 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:57:45,208 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:57:45,208 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:57:45,703 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:58:05,301 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:58:05,302 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:58:05,302 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:58:05,351 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:58:05,378 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:58:05,395 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:58:05,459 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:58:05,488 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:58:05,498 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:58:05,498 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:58:05,522 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:58:07,936 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:58:07,936 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:58:07,936 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:58:08,353 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 22:58:08,355 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 22:58:08,355 - Validate -INFO -print_schema done, go ....
2024-02-22 22:58:08,355 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 22:58:08,358 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 22:58:08,358 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 22:58:08,358 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 22:58:08,358 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 22:58:08,358 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 22:58:08,358 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 22:58:08,358 - Validate -INFO -print_schema done, go ....
2024-02-22 22:58:08,358 - root -INFO -Showing the report 1!
2024-02-22 22:58:08,358 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 22:58:08,364 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 22:58:08,449 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 22:58:08,510 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 22:58:08,611 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 22:58:23,969 - root -INFO -Showing the report 2!
2024-02-22 22:58:23,969 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 22:58:24,230 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 22:58:32,859 - root -INFO -The app done
2024-02-22 22:59:07,447 - root -INFO -calling spark object
2024-02-22 22:59:07,448 - Create_spark -INFO -master is local[*]
2024-02-22 22:59:14,093 - Create_spark -INFO -Spark object created.....
2024-02-22 22:59:14,093 - root -INFO -Spark object is created!
2024-02-22 22:59:14,093 - root -INFO -Validating spark object
2024-02-22 22:59:14,093 - Validate -WARNING -started the get_current_date method...
2024-02-22 22:59:20,242 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 22:59:20,243 - Validate -WARNING -Validation done , go frwd...
2024-02-22 22:59:20,243 - root -INFO -Get file info from olap src
2024-02-22 22:59:20,243 - root -INFO -reading file which is of > parquet
2024-02-22 22:59:20,243 - root -INFO -Load the cities data
2024-02-22 22:59:20,243 - Ingest -WARNING -load_files method started
2024-02-22 22:59:21,343 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:59:25,422 - root -INFO -Number of records of city table is 28338 
2024-02-22 22:59:25,423 - root -INFO -Get the file info from oltp src
2024-02-22 22:59:25,423 - root -INFO -reading file which is of > csv
2024-02-22 22:59:25,423 - root -INFO -Load the presc medicare data
2024-02-22 22:59:25,423 - Ingest -WARNING -load_files method started
2024-02-22 22:59:31,135 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 22:59:32,799 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 22:59:32,800 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 22:59:32,800 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 22:59:33,805 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 22:59:55,495 - root -INFO -Cleaning the two dataframe!
2024-02-22 22:59:55,495 - Data_processing -WARNING -data_clean method() started...
2024-02-22 22:59:55,495 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 22:59:55,527 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 22:59:55,550 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 22:59:55,559 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 22:59:55,600 - Data_processing -WARNING -concat first and last name 
2024-02-22 22:59:55,625 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 22:59:55,639 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 22:59:55,639 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 22:59:55,667 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 22:59:57,920 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 22:59:57,920 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 22:59:57,920 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 22:59:58,378 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 22:59:58,380 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 22:59:58,381 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 22:59:58,381 - Validate -INFO -print_schema done, go ....
2024-02-22 22:59:58,381 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 22:59:58,382 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 22:59:58,383 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 22:59:58,383 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 22:59:58,383 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 22:59:58,383 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 22:59:58,383 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 22:59:58,383 - Validate -INFO -print_schema done, go ....
2024-02-22 22:59:58,383 - root -INFO -Showing the report 1!
2024-02-22 22:59:58,383 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 22:59:58,388 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 22:59:58,480 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 22:59:58,581 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 22:59:58,703 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 23:00:14,444 - root -INFO -Showing the report 2!
2024-02-22 23:00:14,444 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 23:00:14,659 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 23:00:24,190 - root -INFO -The app done
2024-02-22 23:07:48,060 - root -INFO -calling spark object
2024-02-22 23:07:48,060 - Create_spark -INFO -master is local[*]
2024-02-22 23:07:54,698 - Create_spark -INFO -Spark object created.....
2024-02-22 23:07:54,698 - root -INFO -Spark object is created!
2024-02-22 23:07:54,698 - root -INFO -Validating spark object
2024-02-22 23:07:54,698 - Validate -WARNING -started the get_current_date method...
2024-02-22 23:08:00,796 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 23:08:00,796 - Validate -WARNING -Validation done , go frwd...
2024-02-22 23:08:00,797 - root -INFO -Get file info from olap src
2024-02-22 23:08:00,797 - root -INFO -reading file which is of > parquet
2024-02-22 23:08:00,797 - root -INFO -Load the cities data
2024-02-22 23:08:00,797 - Ingest -WARNING -load_files method started
2024-02-22 23:08:01,864 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:08:05,765 - root -INFO -Number of records of city table is 28338 
2024-02-22 23:08:05,766 - root -INFO -Get the file info from oltp src
2024-02-22 23:08:05,766 - root -INFO -reading file which is of > csv
2024-02-22 23:08:05,766 - root -INFO -Load the presc medicare data
2024-02-22 23:08:05,766 - Ingest -WARNING -load_files method started
2024-02-22 23:08:13,582 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:08:16,767 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 23:08:16,768 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 23:08:16,768 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 23:08:17,914 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 23:08:40,895 - root -INFO -Cleaning the two dataframe!
2024-02-22 23:08:40,895 - Data_processing -WARNING -data_clean method() started...
2024-02-22 23:08:40,895 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 23:08:40,932 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 23:08:40,956 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 23:08:40,971 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 23:08:41,033 - Data_processing -WARNING -concat first and last name 
2024-02-22 23:08:41,060 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 23:08:41,075 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 23:08:41,075 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 23:08:41,126 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 23:08:43,746 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 23:08:43,747 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 23:08:43,748 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 23:08:44,342 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 23:08:44,343 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 23:08:44,344 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 23:08:44,344 - Validate -INFO -print_schema done, go ....
2024-02-22 23:08:44,344 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 23:08:44,346 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 23:08:44,346 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 23:08:44,346 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 23:08:44,346 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 23:08:44,346 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 23:08:44,346 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 23:08:44,346 - Validate -INFO -print_schema done, go ....
2024-02-22 23:08:44,346 - root -INFO -Showing the report 1!
2024-02-22 23:08:44,347 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 23:08:44,352 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 23:08:44,408 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 23:08:44,500 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 23:08:44,624 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 23:09:00,372 - root -INFO -Showing the report 2!
2024-02-22 23:09:00,372 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 23:09:00,619 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 23:09:00,619 - root -INFO -Loadin to the postgresQl
2024-02-22 23:09:01,015 - root -INFO -The app done
2024-02-22 23:17:35,125 - root -INFO -calling spark object
2024-02-22 23:17:35,125 - Create_spark -INFO -master is local[*]
2024-02-22 23:17:41,747 - Create_spark -INFO -Spark object created.....
2024-02-22 23:17:41,747 - root -INFO -Spark object is created!
2024-02-22 23:17:41,747 - root -INFO -Validating spark object
2024-02-22 23:17:41,747 - Validate -WARNING -started the get_current_date method...
2024-02-22 23:17:47,433 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 23:17:47,433 - Validate -WARNING -Validation done , go frwd...
2024-02-22 23:17:47,433 - root -INFO -Get file info from olap src
2024-02-22 23:17:47,433 - root -INFO -reading file which is of > parquet
2024-02-22 23:17:47,433 - root -INFO -Load the cities data
2024-02-22 23:17:47,434 - Ingest -WARNING -load_files method started
2024-02-22 23:17:48,322 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:17:51,876 - root -INFO -Number of records of city table is 28338 
2024-02-22 23:17:51,876 - root -INFO -Get the file info from oltp src
2024-02-22 23:17:51,876 - root -INFO -reading file which is of > csv
2024-02-22 23:17:51,877 - root -INFO -Load the presc medicare data
2024-02-22 23:17:51,877 - Ingest -WARNING -load_files method started
2024-02-22 23:17:55,044 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:17:56,708 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 23:17:56,708 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 23:17:56,708 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 23:17:57,273 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 23:18:05,933 - root -INFO -Cleaning the two dataframe!
2024-02-22 23:18:05,933 - Data_processing -WARNING -data_clean method() started...
2024-02-22 23:18:05,933 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 23:18:05,964 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 23:18:05,981 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 23:18:05,991 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 23:18:06,035 - Data_processing -WARNING -concat first and last name 
2024-02-22 23:18:06,053 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 23:18:06,059 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 23:18:06,059 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 23:18:06,081 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 23:18:07,417 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 23:18:07,417 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 23:18:07,417 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 23:18:07,842 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 23:18:07,844 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 23:18:07,844 - Validate -INFO -print_schema done, go ....
2024-02-22 23:18:07,845 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 23:18:07,846 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 23:18:07,846 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 23:18:07,846 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 23:18:07,846 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 23:18:07,846 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 23:18:07,846 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 23:18:07,846 - Validate -INFO -print_schema done, go ....
2024-02-22 23:18:07,846 - root -INFO -Showing the report 1!
2024-02-22 23:18:07,846 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 23:18:07,850 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 23:18:07,899 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 23:18:07,956 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 23:18:08,014 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 23:18:18,180 - root -INFO -Showing the report 2!
2024-02-22 23:18:18,180 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 23:18:18,341 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 23:18:18,341 - root -INFO -Loadin to the postgresQl
2024-02-22 23:18:18,561 - root -INFO -The app done
2024-02-22 23:25:35,411 - root -INFO -calling spark object
2024-02-22 23:25:35,411 - Create_spark -INFO -master is local[*]
2024-02-22 23:25:42,962 - Create_spark -INFO -Spark object created.....
2024-02-22 23:25:42,962 - root -INFO -Spark object is created!
2024-02-22 23:25:42,962 - root -INFO -Validating spark object
2024-02-22 23:25:42,962 - Validate -WARNING -started the get_current_date method...
2024-02-22 23:25:49,013 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 23:25:49,013 - Validate -WARNING -Validation done , go frwd...
2024-02-22 23:25:49,013 - root -INFO -Get file info from olap src
2024-02-22 23:25:49,013 - root -INFO -reading file which is of > parquet
2024-02-22 23:25:49,013 - root -INFO -Load the cities data
2024-02-22 23:25:49,013 - Ingest -WARNING -load_files method started
2024-02-22 23:25:50,117 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:25:54,329 - root -INFO -Number of records of city table is 28338 
2024-02-22 23:25:54,330 - root -INFO -Get the file info from oltp src
2024-02-22 23:25:54,330 - root -INFO -reading file which is of > csv
2024-02-22 23:25:54,330 - root -INFO -Load the presc medicare data
2024-02-22 23:25:54,330 - Ingest -WARNING -load_files method started
2024-02-22 23:25:58,319 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:26:00,081 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 23:26:00,081 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 23:26:00,081 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 23:26:00,714 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 23:26:11,116 - root -INFO -Cleaning the two dataframe!
2024-02-22 23:26:11,116 - Data_processing -WARNING -data_clean method() started...
2024-02-22 23:26:11,116 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 23:26:11,180 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 23:26:11,212 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 23:26:11,230 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 23:26:11,319 - Data_processing -WARNING -concat first and last name 
2024-02-22 23:26:11,356 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 23:26:11,371 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 23:26:11,371 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 23:26:11,398 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 23:26:13,931 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 23:26:13,931 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 23:26:13,931 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 23:26:14,672 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 23:26:14,675 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 23:26:14,676 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 23:26:14,676 - Validate -INFO -print_schema done, go ....
2024-02-22 23:26:14,676 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 23:26:14,678 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 23:26:14,678 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 23:26:14,680 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 23:26:14,680 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 23:26:14,680 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 23:26:14,680 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 23:26:14,680 - Validate -INFO -print_schema done, go ....
2024-02-22 23:26:14,680 - root -INFO -Showing the report 1!
2024-02-22 23:26:14,681 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 23:26:14,689 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 23:26:14,788 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 23:26:14,895 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 23:26:15,130 - root -ERROR -Exception while sending command.
Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=820>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-22 23:26:15,210 - root -ERROR -Exception while sending command.
Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Tools\spark-3.5.0-bin-hadoop3-scala2.13\python\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "C:\Tools\spark-3.5.0-bin-hadoop3-scala2.13\python\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Tools\spark-3.5.0-bin-hadoop3-scala2.13\python\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o16.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-22 23:26:15,309 - root -INFO -The app done
2024-02-22 23:28:09,786 - root -INFO -calling spark object
2024-02-22 23:28:09,786 - Create_spark -INFO -master is local[*]
2024-02-22 23:28:17,756 - Create_spark -INFO -Spark object created.....
2024-02-22 23:28:17,756 - root -INFO -Spark object is created!
2024-02-22 23:28:17,756 - root -INFO -Validating spark object
2024-02-22 23:28:17,758 - Validate -WARNING -started the get_current_date method...
2024-02-22 23:28:23,978 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 23:28:23,978 - Validate -WARNING -Validation done , go frwd...
2024-02-22 23:28:23,978 - root -INFO -Get file info from olap src
2024-02-22 23:28:23,978 - root -INFO -reading file which is of > parquet
2024-02-22 23:28:23,978 - root -INFO -Load the cities data
2024-02-22 23:28:23,978 - Ingest -WARNING -load_files method started
2024-02-22 23:28:24,986 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:28:28,851 - root -INFO -Number of records of city table is 28338 
2024-02-22 23:28:28,851 - root -INFO -Get the file info from oltp src
2024-02-22 23:28:28,851 - root -INFO -reading file which is of > csv
2024-02-22 23:28:28,851 - root -INFO -Load the presc medicare data
2024-02-22 23:28:28,852 - Ingest -WARNING -load_files method started
2024-02-22 23:28:32,991 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:28:34,051 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 23:28:34,051 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 23:28:34,051 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 23:28:34,598 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 23:28:43,640 - root -INFO -Cleaning the two dataframe!
2024-02-22 23:28:43,640 - Data_processing -WARNING -data_clean method() started...
2024-02-22 23:28:43,640 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 23:28:43,681 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 23:28:43,711 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 23:28:43,728 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 23:28:43,791 - Data_processing -WARNING -concat first and last name 
2024-02-22 23:28:43,820 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 23:28:43,835 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 23:28:43,835 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 23:28:43,862 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 23:28:45,676 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 23:28:45,676 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 23:28:45,676 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 23:28:46,258 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 23:28:46,260 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 23:28:46,260 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 23:28:46,260 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 23:28:46,260 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 23:28:46,261 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 23:28:46,261 - Validate -INFO -print_schema done, go ....
2024-02-22 23:28:46,261 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 23:28:46,264 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 23:28:46,264 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 23:28:46,264 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 23:28:46,264 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 23:28:46,264 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 23:28:46,264 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 23:28:46,264 - Validate -INFO -print_schema done, go ....
2024-02-22 23:28:46,264 - root -INFO -Showing the report 1!
2024-02-22 23:28:46,264 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 23:28:46,272 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 23:28:46,346 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 23:28:46,426 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 23:28:46,519 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 23:28:56,278 - root -INFO -Showing the report 2!
2024-02-22 23:28:56,278 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 23:28:56,467 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 23:28:56,468 - root -INFO -Loadin to the postgresQl
2024-02-22 23:28:56,687 - root -INFO -The app done
2024-02-22 23:46:27,901 - root -INFO -calling spark object
2024-02-22 23:46:27,901 - Create_spark -INFO -master is local[*]
2024-02-22 23:46:35,450 - Create_spark -INFO -Spark object created.....
2024-02-22 23:46:35,450 - root -INFO -Spark object is created!
2024-02-22 23:46:35,450 - root -INFO -Validating spark object
2024-02-22 23:46:35,450 - Validate -WARNING -started the get_current_date method...
2024-02-22 23:46:40,993 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 23:46:40,993 - Validate -WARNING -Validation done , go frwd...
2024-02-22 23:46:40,994 - root -INFO -Get file info from olap src
2024-02-22 23:46:40,994 - root -INFO -reading file which is of > parquet
2024-02-22 23:46:40,994 - root -INFO -Load the cities data
2024-02-22 23:46:40,994 - Ingest -WARNING -load_files method started
2024-02-22 23:46:42,170 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:46:45,942 - root -INFO -Number of records of city table is 28338 
2024-02-22 23:46:45,942 - root -INFO -Get the file info from oltp src
2024-02-22 23:46:45,943 - root -INFO -reading file which is of > csv
2024-02-22 23:46:45,943 - root -INFO -Load the presc medicare data
2024-02-22 23:46:45,943 - Ingest -WARNING -load_files method started
2024-02-22 23:46:49,112 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:46:50,401 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 23:46:50,402 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 23:46:50,402 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 23:46:50,887 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 23:46:59,555 - root -INFO -Cleaning the two dataframe!
2024-02-22 23:46:59,555 - Data_processing -WARNING -data_clean method() started...
2024-02-22 23:46:59,555 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 23:46:59,592 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 23:46:59,619 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 23:46:59,635 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 23:46:59,699 - Data_processing -WARNING -concat first and last name 
2024-02-22 23:46:59,732 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 23:46:59,747 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 23:46:59,747 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 23:46:59,770 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 23:47:00,931 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 23:47:00,931 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 23:47:00,932 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 23:47:01,309 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 23:47:01,311 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 23:47:01,311 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 23:47:01,311 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 23:47:01,311 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 23:47:01,311 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 23:47:01,311 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 23:47:01,312 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 23:47:01,312 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 23:47:01,312 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 23:47:01,312 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 23:47:01,312 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 23:47:01,312 - Validate -INFO -print_schema done, go ....
2024-02-22 23:47:01,312 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 23:47:01,313 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 23:47:01,314 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 23:47:01,314 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 23:47:01,314 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 23:47:01,314 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 23:47:01,314 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 23:47:01,314 - Validate -INFO -print_schema done, go ....
2024-02-22 23:47:01,314 - root -INFO -Showing the report 1!
2024-02-22 23:47:01,315 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 23:47:01,319 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 23:47:01,378 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 23:47:01,439 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 23:47:01,516 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 23:47:11,994 - root -INFO -Showing the report 2!
2024-02-22 23:47:11,994 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 23:47:12,183 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 23:47:12,183 - root -INFO -Loadin to the postgresQl
2024-02-22 23:47:12,455 - root -INFO -The app done
2024-02-22 23:58:52,237 - root -INFO -calling spark object
2024-02-22 23:58:52,238 - Create_spark -INFO -master is local[*]
2024-02-22 23:59:03,070 - Create_spark -INFO -Spark object created.....
2024-02-22 23:59:03,070 - root -INFO -Spark object is created!
2024-02-22 23:59:03,070 - root -INFO -Validating spark object
2024-02-22 23:59:03,070 - Validate -WARNING -started the get_current_date method...
2024-02-22 23:59:16,062 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 22))]
2024-02-22 23:59:16,062 - Validate -WARNING -Validation done , go frwd...
2024-02-22 23:59:16,062 - root -INFO -Get file info from olap src
2024-02-22 23:59:16,062 - root -INFO -reading file which is of > parquet
2024-02-22 23:59:16,062 - root -INFO -Load the cities data
2024-02-22 23:59:16,062 - Ingest -WARNING -load_files method started
2024-02-22 23:59:16,954 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:59:20,319 - root -INFO -Number of records of city table is 28338 
2024-02-22 23:59:20,319 - root -INFO -Get the file info from oltp src
2024-02-22 23:59:20,320 - root -INFO -reading file which is of > csv
2024-02-22 23:59:20,320 - root -INFO -Load the presc medicare data
2024-02-22 23:59:20,320 - Ingest -WARNING -load_files method started
2024-02-22 23:59:23,083 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-22 23:59:24,169 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-22 23:59:24,170 - root -INFO -Count the null value in the presc dataset! 
2024-02-22 23:59:24,170 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-22 23:59:24,668 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-22 23:59:33,121 - root -INFO -Cleaning the two dataframe!
2024-02-22 23:59:33,122 - Data_processing -WARNING -data_clean method() started...
2024-02-22 23:59:33,122 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-22 23:59:33,162 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-22 23:59:33,189 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-22 23:59:33,204 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-22 23:59:33,254 - Data_processing -WARNING -concat first and last name 
2024-02-22 23:59:33,284 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-22 23:59:33,296 - Data_processing -WARNING -now check for null values in all columns
2024-02-22 23:59:33,296 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-22 23:59:33,322 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-22 23:59:34,662 - Data_processing -WARNING -successfully droped the null values....
2024-02-22 23:59:34,662 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-22 23:59:34,662 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-22 23:59:35,179 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-22 23:59:35,182 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-22 23:59:35,182 - Validate -INFO -print_schema done, go ....
2024-02-22 23:59:35,182 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-22 23:59:35,185 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-22 23:59:35,185 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-22 23:59:35,185 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-22 23:59:35,185 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-22 23:59:35,185 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-22 23:59:35,185 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-22 23:59:35,185 - Validate -INFO -print_schema done, go ....
2024-02-22 23:59:35,185 - root -INFO -Showing the report 1!
2024-02-22 23:59:35,185 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-22 23:59:35,191 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-22 23:59:35,248 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-22 23:59:35,334 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-22 23:59:35,431 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-22 23:59:45,531 - root -INFO -Showing the report 2!
2024-02-22 23:59:45,531 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-22 23:59:46,079 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-22 23:59:46,080 - root -INFO -Loadin to the postgresQl
2024-02-22 23:59:46,964 - root -INFO -The app done
2024-02-23 00:06:08,670 - root -INFO -calling spark object
2024-02-23 00:06:08,670 - Create_spark -INFO -master is local[*]
2024-02-23 00:06:14,822 - Create_spark -INFO -Spark object created.....
2024-02-23 00:06:14,822 - root -INFO -Spark object is created!
2024-02-23 00:06:14,822 - root -INFO -Validating spark object
2024-02-23 00:06:14,822 - Validate -WARNING -started the get_current_date method...
2024-02-23 00:06:20,550 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 00:06:20,550 - Validate -WARNING -Validation done , go frwd...
2024-02-23 00:06:20,550 - root -INFO -Get file info from olap src
2024-02-23 00:06:20,550 - root -INFO -reading file which is of > parquet
2024-02-23 00:06:20,550 - root -INFO -Load the cities data
2024-02-23 00:06:20,550 - Ingest -WARNING -load_files method started
2024-02-23 00:06:21,493 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 00:06:24,921 - root -INFO -Number of records of city table is 28338 
2024-02-23 00:06:24,921 - root -INFO -Get the file info from oltp src
2024-02-23 00:06:24,922 - root -INFO -reading file which is of > csv
2024-02-23 00:06:24,922 - root -INFO -Load the presc medicare data
2024-02-23 00:06:24,922 - Ingest -WARNING -load_files method started
2024-02-23 00:06:28,623 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 00:06:30,819 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 00:06:30,819 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 00:06:30,819 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 00:06:31,402 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 00:06:40,315 - root -INFO -Cleaning the two dataframe!
2024-02-23 00:06:40,315 - Data_processing -WARNING -data_clean method() started...
2024-02-23 00:06:40,315 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 00:06:40,354 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 00:06:40,371 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 00:06:40,380 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 00:06:40,443 - Data_processing -WARNING -concat first and last name 
2024-02-23 00:06:40,466 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 00:06:40,480 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 00:06:40,480 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 00:06:40,503 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 00:06:42,287 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 00:06:42,287 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 00:06:42,287 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 00:06:42,917 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 00:06:42,921 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 00:06:42,921 - Validate -INFO -print_schema done, go ....
2024-02-23 00:06:42,921 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 00:06:42,923 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 00:06:42,923 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 00:06:42,923 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 00:06:42,923 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 00:06:42,923 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 00:06:42,924 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 00:06:42,924 - Validate -INFO -print_schema done, go ....
2024-02-23 00:06:42,924 - root -INFO -Showing the report 1!
2024-02-23 00:06:42,924 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-23 00:06:42,941 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-23 00:06:43,023 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-23 00:06:43,108 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-23 00:06:43,218 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 00:06:51,359 - root -INFO -Showing the report 2!
2024-02-23 00:06:51,359 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 00:06:51,538 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 00:06:51,538 - root -INFO -Loadin to the postgresQl
2024-02-23 00:06:51,817 - root -INFO -The app done
2024-02-23 00:16:30,687 - root -INFO -calling spark object
2024-02-23 00:16:30,687 - Create_spark -INFO -master is local[*]
2024-02-23 00:16:38,016 - Create_spark -INFO -Spark object created.....
2024-02-23 00:16:38,016 - root -INFO -Spark object is created!
2024-02-23 00:16:38,016 - root -INFO -Validating spark object
2024-02-23 00:16:38,016 - Validate -WARNING -started the get_current_date method...
2024-02-23 00:16:43,222 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 00:16:43,222 - Validate -WARNING -Validation done , go frwd...
2024-02-23 00:16:43,223 - root -INFO -Get file info from olap src
2024-02-23 00:16:43,223 - root -INFO -reading file which is of > parquet
2024-02-23 00:16:43,223 - root -INFO -Load the cities data
2024-02-23 00:16:43,223 - Ingest -WARNING -load_files method started
2024-02-23 00:16:44,074 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 00:16:47,107 - root -INFO -Number of records of city table is 28338 
2024-02-23 00:16:47,107 - root -INFO -Get the file info from oltp src
2024-02-23 00:16:47,108 - root -INFO -reading file which is of > csv
2024-02-23 00:16:47,108 - root -INFO -Load the presc medicare data
2024-02-23 00:16:47,108 - Ingest -WARNING -load_files method started
2024-02-23 00:16:50,329 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 00:16:51,658 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 00:16:51,658 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 00:16:51,658 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 00:16:52,133 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 00:17:00,794 - root -INFO -Cleaning the two dataframe!
2024-02-23 00:17:00,794 - Data_processing -WARNING -data_clean method() started...
2024-02-23 00:17:00,795 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 00:17:00,830 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 00:17:00,853 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 00:17:00,863 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 00:17:00,910 - Data_processing -WARNING -concat first and last name 
2024-02-23 00:17:00,931 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 00:17:00,942 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 00:17:00,942 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 00:17:00,965 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 00:17:02,086 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 00:17:02,086 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 00:17:02,086 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 00:17:02,518 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 00:17:02,521 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 00:17:02,522 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 00:17:02,523 - Validate -INFO -print_schema done, go ....
2024-02-23 00:17:02,523 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 00:17:02,525 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 00:17:02,525 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 00:17:02,526 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 00:17:02,526 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 00:17:02,526 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 00:17:02,526 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 00:17:02,526 - Validate -INFO -print_schema done, go ....
2024-02-23 00:17:02,526 - root -INFO -Showing the report 1!
2024-02-23 00:17:02,526 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-23 00:17:02,532 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-23 00:17:02,596 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-23 00:17:02,644 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-23 00:17:02,705 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 00:17:11,368 - root -INFO -Showing the report 2!
2024-02-23 00:17:11,368 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 00:17:11,556 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 00:17:11,556 - root -INFO -Loadin to the postgresQl
2024-02-23 00:17:18,132 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 00:17:24,181 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 00:17:24,181 - root -INFO -The app done
2024-02-23 11:17:56,029 - root -INFO -calling spark object
2024-02-23 11:17:56,029 - Create_spark -INFO -master is local[*]
2024-02-23 11:18:11,953 - Create_spark -INFO -Spark object created.....
2024-02-23 11:18:11,953 - root -INFO -Spark object is created!
2024-02-23 11:18:11,953 - root -INFO -Validating spark object
2024-02-23 11:18:11,953 - Validate -WARNING -started the get_current_date method...
2024-02-23 11:18:17,230 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 11:18:17,230 - Validate -WARNING -Validation done , go frwd...
2024-02-23 11:18:17,230 - root -INFO -Get file info from olap src
2024-02-23 11:18:17,230 - root -INFO -reading file which is of > parquet
2024-02-23 11:18:17,230 - root -INFO -Load the cities data
2024-02-23 11:18:17,231 - Ingest -WARNING -load_files method started
2024-02-23 11:18:18,018 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:18:20,836 - root -INFO -Number of records of city table is 28338 
2024-02-23 11:18:20,836 - root -INFO -Get the file info from oltp src
2024-02-23 11:18:20,836 - root -INFO -reading file which is of > csv
2024-02-23 11:18:20,836 - root -INFO -Load the presc medicare data
2024-02-23 11:18:20,837 - Ingest -WARNING -load_files method started
2024-02-23 11:18:23,587 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:18:25,163 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 11:18:25,163 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 11:18:25,163 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 11:18:25,648 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 11:18:34,044 - root -INFO -Cleaning the two dataframe!
2024-02-23 11:18:34,044 - Data_processing -WARNING -data_clean method() started...
2024-02-23 11:18:34,045 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 11:18:34,078 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 11:18:34,101 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 11:18:34,113 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 11:18:34,160 - Data_processing -WARNING -concat first and last name 
2024-02-23 11:18:34,181 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 11:18:34,189 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 11:18:34,190 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 11:18:34,209 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 11:18:35,312 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 11:18:35,312 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 11:18:35,312 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 11:18:35,692 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 11:18:35,693 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 11:18:35,693 - Validate -INFO -print_schema done, go ....
2024-02-23 11:18:35,695 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 11:18:35,696 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 11:18:35,696 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 11:18:35,696 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 11:18:35,696 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 11:18:35,696 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 11:18:35,696 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 11:18:35,696 - Validate -INFO -print_schema done, go ....
2024-02-23 11:18:35,696 - root -INFO -Showing the report 1!
2024-02-23 11:18:35,696 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-23 11:18:35,700 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-23 11:18:35,764 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-23 11:18:35,846 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-23 11:18:35,921 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 11:18:46,188 - root -INFO -Showing the report 2!
2024-02-23 11:18:46,188 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 11:18:46,365 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 11:18:46,365 - root -INFO -The app done
2024-02-23 11:19:23,539 - root -INFO -calling spark object
2024-02-23 11:19:23,539 - Create_spark -INFO -master is local[*]
2024-02-23 11:19:29,402 - Create_spark -INFO -Spark object created.....
2024-02-23 11:19:29,402 - root -INFO -Spark object is created!
2024-02-23 11:19:29,402 - root -INFO -Validating spark object
2024-02-23 11:19:29,402 - Validate -WARNING -started the get_current_date method...
2024-02-23 11:19:33,913 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 11:19:33,913 - Validate -WARNING -Validation done , go frwd...
2024-02-23 11:19:33,913 - root -INFO -Get file info from olap src
2024-02-23 11:19:33,913 - root -INFO -reading file which is of > parquet
2024-02-23 11:19:33,913 - root -INFO -Load the cities data
2024-02-23 11:19:33,913 - Ingest -WARNING -load_files method started
2024-02-23 11:19:34,580 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:19:37,470 - root -INFO -Number of records of city table is 28338 
2024-02-23 11:19:37,470 - root -INFO -Get the file info from oltp src
2024-02-23 11:19:37,470 - root -INFO -reading file which is of > csv
2024-02-23 11:19:37,470 - root -INFO -Load the presc medicare data
2024-02-23 11:19:37,470 - Ingest -WARNING -load_files method started
2024-02-23 11:19:40,923 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:19:42,782 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 11:19:42,782 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 11:19:42,782 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 11:19:43,246 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 11:19:51,358 - root -INFO -Cleaning the two dataframe!
2024-02-23 11:19:51,360 - Data_processing -WARNING -data_clean method() started...
2024-02-23 11:19:51,360 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 11:19:51,389 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 11:19:51,407 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 11:19:51,416 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 11:19:51,459 - Data_processing -WARNING -concat first and last name 
2024-02-23 11:19:51,481 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 11:19:51,489 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 11:19:51,489 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 11:19:51,509 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 11:19:52,635 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 11:19:52,635 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 11:19:52,635 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 11:19:52,969 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 11:19:52,970 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 11:19:52,972 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 11:19:52,972 - Validate -INFO -print_schema done, go ....
2024-02-23 11:19:52,972 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 11:19:52,973 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 11:19:52,973 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 11:19:52,973 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 11:19:52,973 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 11:19:52,973 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 11:19:52,973 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 11:19:52,973 - Validate -INFO -print_schema done, go ....
2024-02-23 11:19:52,973 - root -INFO -Showing the report 1!
2024-02-23 11:19:52,973 - root -INFO -Showing the report 2!
2024-02-23 11:19:52,973 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 11:19:53,080 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 11:19:57,775 - root -INFO -The app done
2024-02-23 11:23:05,624 - root -INFO -calling spark object
2024-02-23 11:23:05,624 - Create_spark -INFO -master is local[*]
2024-02-23 11:23:11,145 - Create_spark -INFO -Spark object created.....
2024-02-23 11:23:11,145 - root -INFO -Spark object is created!
2024-02-23 11:23:11,145 - root -INFO -Validating spark object
2024-02-23 11:23:11,145 - Validate -WARNING -started the get_current_date method...
2024-02-23 11:23:15,560 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 11:23:15,560 - Validate -WARNING -Validation done , go frwd...
2024-02-23 11:23:15,560 - root -INFO -Get file info from olap src
2024-02-23 11:23:15,561 - root -INFO -reading file which is of > parquet
2024-02-23 11:23:15,561 - root -INFO -Load the cities data
2024-02-23 11:23:15,561 - Ingest -WARNING -load_files method started
2024-02-23 11:23:16,295 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:23:18,931 - root -INFO -Number of records of city table is 28338 
2024-02-23 11:23:18,931 - root -INFO -Get the file info from oltp src
2024-02-23 11:23:18,932 - root -INFO -reading file which is of > csv
2024-02-23 11:23:18,932 - root -INFO -Load the presc medicare data
2024-02-23 11:23:18,932 - Ingest -WARNING -load_files method started
2024-02-23 11:23:21,362 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:23:22,271 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 11:23:22,271 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 11:23:22,272 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 11:23:22,653 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 11:23:31,136 - root -INFO -Cleaning the two dataframe!
2024-02-23 11:23:31,137 - Data_processing -WARNING -data_clean method() started...
2024-02-23 11:23:31,137 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 11:23:31,195 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 11:23:31,223 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 11:23:31,239 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 11:23:31,943 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 11:23:31,944 - Validate -INFO -	StructField('presc_id', IntegerType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('presc_lname', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('presc_fname', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('years_of_exp', StringType(), True)
2024-02-23 11:23:31,945 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 11:23:31,945 - Validate -INFO -print_schema done, go ....
2024-02-23 11:23:31,945 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 11:23:31,948 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 11:23:31,948 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 11:23:31,948 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 11:23:31,948 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 11:23:31,948 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 11:23:31,948 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 11:23:31,948 - Validate -INFO -print_schema done, go ....
2024-02-23 11:23:31,948 - root -INFO -Showing the report 1!
2024-02-23 11:23:31,948 - root -INFO -Showing the report 2!
2024-02-23 11:23:31,948 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 11:23:32,097 - root -INFO -The app done
2024-02-23 11:25:26,838 - root -INFO -calling spark object
2024-02-23 11:25:26,838 - Create_spark -INFO -master is local[*]
2024-02-23 11:25:31,511 - Create_spark -INFO -Spark object created.....
2024-02-23 11:25:31,511 - root -INFO -Spark object is created!
2024-02-23 11:25:31,511 - root -INFO -Validating spark object
2024-02-23 11:25:31,511 - Validate -WARNING -started the get_current_date method...
2024-02-23 11:25:35,163 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 11:25:35,164 - Validate -WARNING -Validation done , go frwd...
2024-02-23 11:25:35,164 - root -INFO -Get file info from olap src
2024-02-23 11:25:35,164 - root -INFO -reading file which is of > parquet
2024-02-23 11:25:35,164 - root -INFO -Load the cities data
2024-02-23 11:25:35,164 - Ingest -WARNING -load_files method started
2024-02-23 11:25:35,786 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:25:38,173 - root -INFO -Number of records of city table is 28338 
2024-02-23 11:25:38,173 - root -INFO -Get the file info from oltp src
2024-02-23 11:25:38,173 - root -INFO -reading file which is of > csv
2024-02-23 11:25:38,173 - root -INFO -Load the presc medicare data
2024-02-23 11:25:38,173 - Ingest -WARNING -load_files method started
2024-02-23 11:25:40,592 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:25:41,429 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 11:25:41,429 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 11:25:41,429 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 11:25:41,810 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 11:25:49,541 - root -INFO -Cleaning the two dataframe!
2024-02-23 11:25:49,542 - Data_processing -WARNING -data_clean method() started...
2024-02-23 11:25:49,542 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 11:25:49,573 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 11:25:49,594 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 11:25:49,607 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 11:25:49,684 - Data_processing -WARNING -concat first and last name 
2024-02-23 11:25:49,705 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 11:25:49,718 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 11:25:49,718 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 11:25:49,748 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 11:25:50,985 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 11:25:50,986 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 11:25:50,986 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 11:25:51,354 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 11:25:51,355 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 11:25:51,357 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 11:25:51,357 - Validate -INFO -print_schema done, go ....
2024-02-23 11:25:51,357 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 11:25:51,357 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 11:25:51,357 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 11:25:51,357 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 11:25:51,358 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 11:25:51,358 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 11:25:51,358 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 11:25:51,358 - Validate -INFO -print_schema done, go ....
2024-02-23 11:25:51,358 - root -INFO -Showing the report 1!
2024-02-23 11:25:51,358 - root -INFO -Showing the report 2!
2024-02-23 11:25:51,358 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 11:25:51,479 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 11:25:55,476 - root -INFO -The app done
2024-02-23 11:26:21,301 - root -INFO -calling spark object
2024-02-23 11:26:21,302 - Create_spark -INFO -master is local[*]
2024-02-23 11:26:27,081 - Create_spark -INFO -Spark object created.....
2024-02-23 11:26:27,081 - root -INFO -Spark object is created!
2024-02-23 11:26:27,081 - root -INFO -Validating spark object
2024-02-23 11:26:27,081 - Validate -WARNING -started the get_current_date method...
2024-02-23 11:26:30,889 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 11:26:30,889 - Validate -WARNING -Validation done , go frwd...
2024-02-23 11:26:30,889 - root -INFO -Get file info from olap src
2024-02-23 11:26:30,889 - root -INFO -reading file which is of > parquet
2024-02-23 11:26:30,889 - root -INFO -Load the cities data
2024-02-23 11:26:30,891 - Ingest -WARNING -load_files method started
2024-02-23 11:26:31,541 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:26:34,436 - root -INFO -Number of records of city table is 28338 
2024-02-23 11:26:34,437 - root -INFO -Get the file info from oltp src
2024-02-23 11:26:34,437 - root -INFO -reading file which is of > csv
2024-02-23 11:26:34,437 - root -INFO -Load the presc medicare data
2024-02-23 11:26:34,437 - Ingest -WARNING -load_files method started
2024-02-23 11:26:36,940 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 11:26:38,079 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 11:26:38,080 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 11:26:38,080 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 11:26:38,417 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 11:26:46,538 - root -INFO -Cleaning the two dataframe!
2024-02-23 11:26:46,540 - Data_processing -WARNING -data_clean method() started...
2024-02-23 11:26:46,540 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 11:26:46,575 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 11:26:46,597 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 11:26:46,610 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 11:26:46,697 - Data_processing -WARNING -concat first and last name 
2024-02-23 11:26:46,728 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 11:26:46,743 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 11:26:46,743 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 11:26:46,779 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 11:26:48,311 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 11:26:48,311 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 11:26:48,311 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 11:26:48,698 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 11:26:48,699 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 11:26:48,699 - Validate -INFO -print_schema done, go ....
2024-02-23 11:26:48,700 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 11:26:48,700 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 11:26:48,700 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 11:26:48,701 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 11:26:48,701 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 11:26:48,701 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 11:26:48,701 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 11:26:48,701 - Validate -INFO -print_schema done, go ....
2024-02-23 11:26:48,701 - root -INFO -Showing the report 1!
2024-02-23 11:26:48,701 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-23 11:26:48,705 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-23 11:26:48,754 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-23 11:26:48,794 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-23 11:26:48,845 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 11:26:56,892 - root -INFO -Showing the report 2!
2024-02-23 11:26:56,893 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 11:26:57,011 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 11:27:00,681 - root -INFO -Loadin to the postgresQl
2024-02-23 11:27:04,758 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 11:27:11,179 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 11:27:11,179 - root -INFO -The app done
2024-02-23 16:47:36,990 - root -INFO -calling spark object
2024-02-23 16:47:36,991 - Create_spark -INFO -master is local[*]
2024-02-23 16:47:53,070 - Create_spark -INFO -Spark object created.....
2024-02-23 16:47:53,070 - root -INFO -Spark object is created!
2024-02-23 16:47:53,070 - root -INFO -Validating spark object
2024-02-23 16:47:53,070 - Validate -WARNING -started the get_current_date method...
2024-02-23 16:47:58,919 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 23))]
2024-02-23 16:47:58,920 - Validate -WARNING -Validation done , go frwd...
2024-02-23 16:47:58,920 - root -INFO -Get file info from olap src
2024-02-23 16:47:58,920 - root -INFO -reading file which is of > parquet
2024-02-23 16:47:58,920 - root -INFO -Load the cities data
2024-02-23 16:47:58,920 - Ingest -WARNING -load_files method started
2024-02-23 16:47:59,907 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 16:48:02,918 - root -INFO -Number of records of city table is 28338 
2024-02-23 16:48:02,919 - root -INFO -Get the file info from oltp src
2024-02-23 16:48:02,919 - root -INFO -reading file which is of > csv
2024-02-23 16:48:02,919 - root -INFO -Load the presc medicare data
2024-02-23 16:48:02,919 - Ingest -WARNING -load_files method started
2024-02-23 16:48:05,842 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-23 16:48:07,054 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-23 16:48:07,054 - root -INFO -Count the null value in the presc dataset! 
2024-02-23 16:48:07,054 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-23 16:48:07,464 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-23 16:48:16,404 - root -INFO -Cleaning the two dataframe!
2024-02-23 16:48:16,404 - Data_processing -WARNING -data_clean method() started...
2024-02-23 16:48:16,404 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-23 16:48:16,454 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-23 16:48:16,479 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-23 16:48:16,548 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-23 16:48:16,771 - Data_processing -WARNING -concat first and last name 
2024-02-23 16:48:16,797 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-23 16:48:16,810 - Data_processing -WARNING -now check for null values in all columns
2024-02-23 16:48:16,812 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-23 16:48:16,844 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-23 16:48:18,523 - Data_processing -WARNING -successfully droped the null values....
2024-02-23 16:48:18,523 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-23 16:48:18,524 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-23 16:48:18,944 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-23 16:48:18,945 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-23 16:48:18,946 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-23 16:48:18,946 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-23 16:48:18,946 - Validate -INFO -print_schema done, go ....
2024-02-23 16:48:18,946 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-23 16:48:18,947 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-23 16:48:18,947 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-23 16:48:18,947 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-23 16:48:18,947 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-23 16:48:18,948 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-23 16:48:18,948 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-23 16:48:18,948 - Validate -INFO -print_schema done, go ....
2024-02-23 16:48:18,948 - root -INFO -Showing the report 1!
2024-02-23 16:48:18,948 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-23 16:48:18,952 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-23 16:48:19,041 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-23 16:48:19,117 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-23 16:48:19,192 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 16:48:32,097 - root -INFO -Showing the report 2!
2024-02-23 16:48:32,098 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-23 16:48:32,310 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-23 16:48:37,059 - root -INFO -Loadin to the postgresQl
2024-02-23 16:48:40,972 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 16:48:48,000 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 16:48:48,826 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 16:49:07,741 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-23 16:49:07,742 - root -INFO -The app done
2024-02-24 00:52:07,144 - root -INFO -calling spark object
2024-02-24 00:52:07,145 - Create_spark -INFO -master is local[*]
2024-02-24 00:52:13,785 - root -ERROR -KeyboardInterrupt while sending command.
Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
KeyboardInterrupt
2024-02-24 01:07:17,656 - root -INFO -calling spark object
2024-02-24 01:07:17,657 - Create_spark -INFO -master is local[*]
2024-02-24 01:07:26,279 - Create_spark -INFO -Spark object created.....
2024-02-24 01:07:26,279 - root -INFO -Spark object is created!
2024-02-24 01:07:26,279 - root -INFO -Validating spark object
2024-02-24 01:07:26,279 - Validate -WARNING -started the get_current_date method...
2024-02-24 01:07:32,953 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 01:07:32,953 - Validate -WARNING -Validation done , go frwd...
2024-02-24 01:07:32,954 - root -INFO -Get file info from olap src
2024-02-24 01:07:32,954 - root -INFO -reading file which is of > parquet
2024-02-24 01:07:32,955 - root -INFO -Load the cities data
2024-02-24 01:07:32,955 - Ingest -WARNING -load_files method started
2024-02-24 01:07:33,846 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 01:07:37,027 - root -INFO -Number of records of city table is 28338 
2024-02-24 01:07:37,027 - root -INFO -Get the file info from oltp src
2024-02-24 01:07:37,029 - root -INFO -reading file which is of > csv
2024-02-24 01:07:37,029 - root -INFO -Load the presc medicare data
2024-02-24 01:07:37,029 - Ingest -WARNING -load_files method started
2024-02-24 01:07:41,399 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 01:07:43,807 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-24 01:07:43,809 - root -INFO -Count the null value in the presc dataset! 
2024-02-24 01:07:43,809 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-24 01:07:44,281 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-24 01:07:54,157 - root -INFO -Cleaning the two dataframe!
2024-02-24 01:07:54,157 - Data_processing -WARNING -data_clean method() started...
2024-02-24 01:07:54,157 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-24 01:07:54,198 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-24 01:07:54,228 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-24 01:07:54,243 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-24 01:07:54,339 - Data_processing -WARNING -concat first and last name 
2024-02-24 01:07:54,368 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-24 01:07:54,380 - Data_processing -WARNING -now check for null values in all columns
2024-02-24 01:07:54,380 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-24 01:07:54,406 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-24 01:07:56,304 - Data_processing -WARNING -successfully droped the null values....
2024-02-24 01:07:56,304 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-24 01:07:56,304 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-24 01:07:56,816 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-24 01:07:56,818 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-24 01:07:56,819 - Validate -INFO -print_schema done, go ....
2024-02-24 01:07:56,819 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-24 01:07:56,820 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-24 01:07:56,820 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-24 01:07:56,820 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-24 01:07:56,820 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-24 01:07:56,820 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-24 01:07:56,820 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-24 01:07:56,820 - Validate -INFO -print_schema done, go ....
2024-02-24 01:07:56,820 - root -INFO -Showing the report 1!
2024-02-24 01:07:56,820 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-24 01:07:56,825 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-24 01:07:56,877 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-24 01:07:56,950 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-24 01:07:57,036 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 01:08:08,160 - root -INFO -The app done
2024-02-24 02:12:11,438 - root -INFO -calling spark object
2024-02-24 02:12:11,473 - Create_spark -INFO -master is local[*]
2024-02-24 02:12:19,815 - Create_spark -INFO -Spark object created.....
2024-02-24 02:12:19,815 - root -INFO -Spark object is created!
2024-02-24 02:12:19,815 - root -INFO -Validating spark object
2024-02-24 02:12:19,816 - Validate -WARNING -started the get_current_date method...
2024-02-24 02:12:27,725 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 02:12:27,725 - Validate -WARNING -Validation done , go frwd...
2024-02-24 02:12:27,725 - root -INFO -Get file info from olap src
2024-02-24 02:12:27,727 - root -INFO -reading file which is of > parquet
2024-02-24 02:12:27,727 - root -INFO -Load the cities data
2024-02-24 02:12:27,727 - Ingest -WARNING -load_files method started
2024-02-24 02:12:28,868 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 02:12:32,724 - root -INFO -Number of records of city table is 28338 
2024-02-24 02:12:32,724 - root -INFO -Get the file info from oltp src
2024-02-24 02:12:32,725 - root -INFO -reading file which is of > csv
2024-02-24 02:12:32,725 - root -INFO -Load the presc medicare data
2024-02-24 02:12:32,725 - Ingest -WARNING -load_files method started
2024-02-24 02:12:35,727 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 02:12:37,485 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-24 02:12:37,485 - root -INFO -Count the null value in the presc dataset! 
2024-02-24 02:12:37,486 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-24 02:12:38,312 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-24 02:12:47,764 - root -INFO -Cleaning the two dataframe!
2024-02-24 02:12:47,764 - Data_processing -WARNING -data_clean method() started...
2024-02-24 02:12:47,764 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-24 02:12:47,823 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-24 02:12:47,851 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-24 02:12:47,867 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-24 02:12:48,011 - Data_processing -WARNING -concat first and last name 
2024-02-24 02:12:48,048 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-24 02:12:48,061 - Data_processing -WARNING -now check for null values in all columns
2024-02-24 02:12:48,061 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-24 02:12:48,090 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-24 02:12:50,898 - Data_processing -WARNING -successfully droped the null values....
2024-02-24 02:12:50,898 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-24 02:12:50,898 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-24 02:12:51,430 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-24 02:12:51,430 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-24 02:12:51,434 - Validate -INFO -print_schema done, go ....
2024-02-24 02:12:51,434 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-24 02:12:51,436 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-24 02:12:51,436 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-24 02:12:51,436 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-24 02:12:51,436 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-24 02:12:51,436 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-24 02:12:51,436 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-24 02:12:51,436 - Validate -INFO -print_schema done, go ....
2024-02-24 02:12:51,436 - root -INFO -Showing the report 1!
2024-02-24 02:12:51,436 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-24 02:12:51,445 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-24 02:12:51,534 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-24 02:12:51,628 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-24 02:12:51,744 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 02:13:08,804 - root -INFO -Showing the report 2!
2024-02-24 02:13:08,804 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-24 02:13:08,984 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-24 02:13:14,928 - root -INFO -The app done
2024-02-24 04:40:54,000 - root -INFO -calling spark object
2024-02-24 04:40:54,000 - Create_spark -INFO -master is local[*]
2024-02-24 04:41:03,526 - Create_spark -INFO -Spark object created.....
2024-02-24 04:41:03,526 - root -INFO -Spark object is created!
2024-02-24 04:41:03,526 - root -INFO -Validating spark object
2024-02-24 04:41:03,526 - Validate -WARNING -started the get_current_date method...
2024-02-24 04:41:09,222 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 04:41:09,222 - Validate -WARNING -Validation done , go frwd...
2024-02-24 04:41:09,222 - root -INFO -Get file info from olap src
2024-02-24 04:41:09,223 - root -INFO -reading file which is of > parquet
2024-02-24 04:41:09,223 - root -INFO -Load the cities data
2024-02-24 04:41:09,223 - Ingest -WARNING -load_files method started
2024-02-24 04:41:10,214 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 04:41:13,996 - root -INFO -Number of records of city table is 28338 
2024-02-24 04:41:13,996 - root -INFO -Get the file info from oltp src
2024-02-24 04:41:13,996 - root -INFO -reading file which is of > csv
2024-02-24 04:41:13,996 - root -INFO -Load the presc medicare data
2024-02-24 04:41:13,996 - Ingest -WARNING -load_files method started
2024-02-24 04:41:17,801 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 04:41:19,001 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-24 04:41:19,001 - root -INFO -Count the null value in the presc dataset! 
2024-02-24 04:41:19,001 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-24 04:41:19,554 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-24 04:41:36,675 - root -INFO -Cleaning the two dataframe!
2024-02-24 04:41:36,676 - Data_processing -WARNING -data_clean method() started...
2024-02-24 04:41:36,676 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-24 04:41:36,706 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-24 04:41:36,726 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-24 04:41:36,736 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-24 04:41:36,809 - Data_processing -WARNING -concat first and last name 
2024-02-24 04:41:36,835 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-24 04:41:36,848 - Data_processing -WARNING -now check for null values in all columns
2024-02-24 04:41:36,848 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-24 04:41:36,874 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-24 04:41:39,217 - Data_processing -WARNING -successfully droped the null values....
2024-02-24 04:41:39,217 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-24 04:41:39,217 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-24 04:41:39,641 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-24 04:41:39,642 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-24 04:41:39,642 - Validate -INFO -print_schema done, go ....
2024-02-24 04:41:39,642 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-24 04:41:39,644 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-24 04:41:39,644 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-24 04:41:39,644 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-24 04:41:39,644 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-24 04:41:39,644 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-24 04:41:39,644 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-24 04:41:39,644 - Validate -INFO -print_schema done, go ....
2024-02-24 04:41:39,644 - root -INFO -Showing the report 1!
2024-02-24 04:41:39,644 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-24 04:41:39,647 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-24 04:41:39,702 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-24 04:41:39,776 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-24 04:41:39,858 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 04:41:50,631 - root -INFO -Showing the report 2!
2024-02-24 04:41:50,631 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-24 04:41:50,815 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-24 04:41:57,291 - root -INFO -The app done
2024-02-24 04:44:20,946 - root -INFO -calling spark object
2024-02-24 04:44:20,946 - Create_spark -INFO -master is local[*]
2024-02-24 04:44:27,535 - Create_spark -INFO -Spark object created.....
2024-02-24 04:44:27,536 - root -INFO -Spark object is created!
2024-02-24 04:44:27,536 - root -INFO -Validating spark object
2024-02-24 04:44:27,536 - Validate -WARNING -started the get_current_date method...
2024-02-24 04:44:32,770 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 04:44:32,770 - Validate -WARNING -Validation done , go frwd...
2024-02-24 04:44:32,770 - root -INFO -Get file info from olap src
2024-02-24 04:44:32,770 - root -INFO -reading file which is of > parquet
2024-02-24 04:44:32,770 - root -INFO -Load the cities data
2024-02-24 04:44:32,773 - Ingest -WARNING -load_files method started
2024-02-24 04:44:33,623 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 04:44:37,013 - root -INFO -Number of records of city table is 28338 
2024-02-24 04:44:37,013 - root -INFO -Get the file info from oltp src
2024-02-24 04:44:37,013 - root -INFO -reading file which is of > csv
2024-02-24 04:44:37,013 - root -INFO -Load the presc medicare data
2024-02-24 04:44:37,013 - Ingest -WARNING -load_files method started
2024-02-24 04:44:40,299 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 04:44:41,296 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-24 04:44:41,296 - root -INFO -Count the null value in the presc dataset! 
2024-02-24 04:44:41,296 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-24 04:44:41,749 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-24 04:44:57,432 - root -INFO -Cleaning the two dataframe!
2024-02-24 04:44:57,432 - Data_processing -WARNING -data_clean method() started...
2024-02-24 04:44:57,432 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-24 04:44:57,468 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-24 04:44:57,499 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-24 04:44:57,510 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-24 04:44:57,579 - Data_processing -WARNING -concat first and last name 
2024-02-24 04:44:57,602 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-24 04:44:57,617 - Data_processing -WARNING -now check for null values in all columns
2024-02-24 04:44:57,617 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-24 04:44:57,648 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-24 04:44:59,349 - Data_processing -WARNING -successfully droped the null values....
2024-02-24 04:44:59,349 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-24 04:44:59,352 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-24 04:44:59,698 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-24 04:44:59,698 - Validate -INFO -print_schema done, go ....
2024-02-24 04:44:59,698 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-24 04:44:59,698 - Validate -INFO -print_schema done, go ....
2024-02-24 04:44:59,698 - root -INFO -Showing the report 1!
2024-02-24 04:44:59,698 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-24 04:44:59,698 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-24 04:44:59,766 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-24 04:44:59,833 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-24 04:44:59,915 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 04:45:08,086 - root -INFO -Showing the report 2!
2024-02-24 04:45:08,086 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-24 04:45:08,263 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-24 04:45:12,815 - root -INFO -The app done
2024-02-24 04:47:21,115 - root -INFO -calling spark object
2024-02-24 04:47:21,115 - Create_spark -INFO -master is local[*]
2024-02-24 04:47:24,733 - Create_spark -INFO -Spark object created.....
2024-02-24 04:47:24,733 - root -INFO -Spark object is created!
2024-02-24 04:47:24,733 - root -INFO -Validating spark object
2024-02-24 04:47:24,733 - Validate -WARNING -started the get_current_date method...
2024-02-24 04:47:30,187 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 04:47:30,187 - Validate -WARNING -Validation done , go frwd...
2024-02-24 04:47:30,187 - root -INFO -Get file info from olap src
2024-02-24 04:47:30,188 - root -INFO -reading file which is of > parquet
2024-02-24 04:47:30,188 - root -INFO -Load the cities data
2024-02-24 04:47:30,188 - Ingest -WARNING -load_files method started
2024-02-24 04:47:30,853 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 04:47:33,872 - root -INFO -Number of records of city table is 28338 
2024-02-24 04:47:33,872 - root -INFO -Get the file info from oltp src
2024-02-24 04:47:33,872 - root -INFO -reading file which is of > csv
2024-02-24 04:47:33,873 - root -INFO -Load the presc medicare data
2024-02-24 04:47:33,873 - Ingest -WARNING -load_files method started
2024-02-24 04:47:37,237 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 04:47:38,258 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-24 04:47:38,258 - root -INFO -Count the null value in the presc dataset! 
2024-02-24 04:47:38,262 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-24 04:47:38,719 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-24 04:47:54,518 - root -INFO -Cleaning the two dataframe!
2024-02-24 04:47:54,518 - Data_processing -WARNING -data_clean method() started...
2024-02-24 04:47:54,518 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-24 04:47:54,558 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-24 04:47:54,576 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-24 04:47:54,590 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-24 04:47:54,657 - Data_processing -WARNING -concat first and last name 
2024-02-24 04:47:54,685 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-24 04:47:54,693 - Data_processing -WARNING -now check for null values in all columns
2024-02-24 04:47:54,693 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-24 04:47:54,718 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-24 04:47:56,752 - Data_processing -WARNING -successfully droped the null values....
2024-02-24 04:47:56,753 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-24 04:47:56,753 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-24 04:47:57,132 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-24 04:47:57,132 - Validate -INFO -print_schema done, go ....
2024-02-24 04:47:57,132 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-24 04:47:57,132 - Validate -INFO -print_schema done, go ....
2024-02-24 04:47:57,132 - root -INFO -Showing the report 1!
2024-02-24 04:47:57,132 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-24 04:47:57,132 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-24 04:47:57,186 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-24 04:47:57,224 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-24 04:47:57,280 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 04:48:08,025 - root -INFO -Showing the report 2!
2024-02-24 04:48:08,026 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-24 04:48:08,153 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-24 04:48:14,379 - root -INFO -The app done
2024-02-24 08:30:33,516 - root -INFO -calling spark object
2024-02-24 08:30:33,516 - Create_spark -INFO -master is local[*]
2024-02-24 08:30:50,920 - Create_spark -INFO -Spark object created.....
2024-02-24 08:30:50,921 - root -INFO -Spark object is created!
2024-02-24 08:30:50,921 - root -INFO -Validating spark object
2024-02-24 08:30:50,921 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:30:56,270 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:30:56,270 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:30:56,271 - Ingest -WARNING -load_files method started
2024-02-24 08:30:56,271 - Ingest -ERROR -An error occurred while dealing with load_file ===='SparkSession' object has no attribute 'textFile'
2024-02-24 08:30:56,279 - root -INFO -The app done
2024-02-24 08:33:45,694 - root -INFO -calling spark object
2024-02-24 08:33:45,694 - Create_spark -INFO -master is local[*]
2024-02-24 08:33:50,938 - Create_spark -INFO -Spark object created.....
2024-02-24 08:33:50,938 - root -INFO -Spark object is created!
2024-02-24 08:33:50,939 - root -INFO -Validating spark object
2024-02-24 08:33:50,939 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:33:54,534 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:33:54,534 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:33:54,534 - Ingest -WARNING -load_files method started
2024-02-24 08:33:54,542 - Ingest -ERROR -An error occurred while dealing with load_file ===='DataFrameReader' object has no attribute 'txt'
2024-02-24 08:33:54,545 - root -INFO -The app done
2024-02-24 08:48:39,261 - root -INFO -calling spark object
2024-02-24 08:48:39,261 - Create_spark -INFO -master is local[*]
2024-02-24 08:48:45,921 - Create_spark -INFO -Spark object created.....
2024-02-24 08:48:45,921 - root -INFO -Spark object is created!
2024-02-24 08:48:45,921 - root -INFO -Validating spark object
2024-02-24 08:48:45,921 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:48:51,342 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:48:51,342 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:48:51,343 - Ingest -WARNING -load_files method started
2024-02-24 08:48:51,343 - Ingest -ERROR -An error occurred while dealing with load_file ===='SparkSession' object has no attribute 'wholeTextFiles'
2024-02-24 08:48:51,348 - root -INFO -The app done
2024-02-24 08:51:24,086 - root -INFO -calling spark object
2024-02-24 08:51:24,086 - Create_spark -INFO -master is local[*]
2024-02-24 08:51:28,474 - Create_spark -INFO -Spark object created.....
2024-02-24 08:51:28,474 - root -INFO -Spark object is created!
2024-02-24 08:51:28,474 - root -INFO -Validating spark object
2024-02-24 08:51:28,474 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:51:32,213 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:51:32,214 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:51:32,214 - Ingest -WARNING -load_files method started
2024-02-24 08:51:32,286 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:51:32,354 - root -INFO -The app done
2024-02-24 08:52:49,967 - root -INFO -calling spark object
2024-02-24 08:52:49,967 - Create_spark -INFO -master is local[*]
2024-02-24 08:52:54,873 - Create_spark -INFO -Spark object created.....
2024-02-24 08:52:54,873 - root -INFO -Spark object is created!
2024-02-24 08:52:54,873 - root -INFO -Validating spark object
2024-02-24 08:52:54,873 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:52:59,112 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:52:59,112 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:52:59,112 - Ingest -WARNING -load_files method started
2024-02-24 08:52:59,198 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:53:01,240 - root -INFO -The app done
2024-02-24 08:54:47,725 - root -INFO -calling spark object
2024-02-24 08:54:47,726 - Create_spark -INFO -master is local[*]
2024-02-24 08:54:52,790 - Create_spark -INFO -Spark object created.....
2024-02-24 08:54:52,790 - root -INFO -Spark object is created!
2024-02-24 08:54:52,790 - root -INFO -Validating spark object
2024-02-24 08:54:52,790 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:54:56,375 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:54:56,375 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:54:56,375 - Ingest -WARNING -load_files method started
2024-02-24 08:54:56,454 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:54:56,459 - root -INFO -The app done
2024-02-24 08:56:32,167 - root -INFO -calling spark object
2024-02-24 08:56:32,167 - Create_spark -INFO -master is local[*]
2024-02-24 08:56:37,534 - Create_spark -INFO -Spark object created.....
2024-02-24 08:56:37,535 - root -INFO -Spark object is created!
2024-02-24 08:56:37,535 - root -INFO -Validating spark object
2024-02-24 08:56:37,535 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:56:42,066 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:56:42,066 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:56:42,066 - Ingest -WARNING -load_files method started
2024-02-24 08:56:42,175 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:56:44,178 - Ingest -WARNING -load_files method started
2024-02-24 08:56:44,217 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:56:45,961 - root -INFO -The app done
2024-02-24 08:57:46,766 - root -INFO -calling spark object
2024-02-24 08:57:46,766 - Create_spark -INFO -master is local[*]
2024-02-24 08:57:52,097 - Create_spark -INFO -Spark object created.....
2024-02-24 08:57:52,098 - root -INFO -Spark object is created!
2024-02-24 08:57:52,098 - root -INFO -Validating spark object
2024-02-24 08:57:52,098 - Validate -WARNING -started the get_current_date method...
2024-02-24 08:57:57,050 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 08:57:57,050 - Validate -WARNING -Validation done , go frwd...
2024-02-24 08:57:57,051 - Ingest -WARNING -load_files method started
2024-02-24 08:57:57,111 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:57:58,839 - Ingest -WARNING -load_files method started
2024-02-24 08:57:58,868 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 08:58:00,317 - root -INFO -The app done
2024-02-24 08:59:59,223 - root -INFO -calling spark object
2024-02-24 08:59:59,223 - Create_spark -INFO -master is local[*]
2024-02-24 09:00:04,230 - Create_spark -INFO -Spark object created.....
2024-02-24 09:00:04,230 - root -INFO -Spark object is created!
2024-02-24 09:00:04,230 - root -INFO -Validating spark object
2024-02-24 09:00:04,230 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:00:09,056 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:00:09,056 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:00:09,057 - Ingest -WARNING -load_files method started
2024-02-24 09:00:09,144 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:00:09,182 - root -INFO -The app done
2024-02-24 09:00:41,071 - root -INFO -calling spark object
2024-02-24 09:00:41,072 - Create_spark -INFO -master is local[*]
2024-02-24 09:00:45,907 - Create_spark -INFO -Spark object created.....
2024-02-24 09:00:45,907 - root -INFO -Spark object is created!
2024-02-24 09:00:45,907 - root -INFO -Validating spark object
2024-02-24 09:00:45,907 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:00:49,558 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:00:49,558 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:00:49,558 - Ingest -WARNING -load_files method started
2024-02-24 09:00:49,628 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:00:51,260 - Ingest -WARNING -load_files method started
2024-02-24 09:00:51,283 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:00:52,701 - root -INFO -The app done
2024-02-24 09:03:18,485 - root -INFO -calling spark object
2024-02-24 09:03:18,485 - Create_spark -INFO -master is local[*]
2024-02-24 09:03:23,773 - Create_spark -INFO -Spark object created.....
2024-02-24 09:03:23,773 - root -INFO -Spark object is created!
2024-02-24 09:03:23,773 - root -INFO -Validating spark object
2024-02-24 09:03:23,773 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:03:27,599 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:03:27,599 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:03:27,599 - Ingest -WARNING -load_files method started
2024-02-24 09:03:27,678 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:03:30,220 - Ingest -WARNING -load_files method started
2024-02-24 09:03:30,247 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:03:32,565 - root -INFO -The app done
2024-02-24 09:19:48,776 - root -INFO -calling spark object
2024-02-24 09:19:48,776 - Create_spark -INFO -master is local[*]
2024-02-24 09:19:54,915 - Create_spark -INFO -Spark object created.....
2024-02-24 09:19:54,915 - root -INFO -Spark object is created!
2024-02-24 09:19:54,916 - root -INFO -Validating spark object
2024-02-24 09:19:54,916 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:19:59,410 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:19:59,411 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:19:59,411 - Ingest -WARNING -load_files method started
2024-02-24 09:19:59,477 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:20:05,530 - root -INFO -The app done
2024-02-24 09:20:47,391 - root -INFO -calling spark object
2024-02-24 09:20:47,391 - Create_spark -INFO -master is local[*]
2024-02-24 09:20:52,311 - Create_spark -INFO -Spark object created.....
2024-02-24 09:20:52,311 - root -INFO -Spark object is created!
2024-02-24 09:20:52,311 - root -INFO -Validating spark object
2024-02-24 09:20:52,311 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:20:56,171 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:20:56,171 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:20:56,172 - Ingest -WARNING -load_files method started
2024-02-24 09:20:56,246 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:21:00,703 - root -INFO -The app done
2024-02-24 09:22:27,461 - root -INFO -calling spark object
2024-02-24 09:22:27,461 - Create_spark -INFO -master is local[*]
2024-02-24 09:22:31,809 - Create_spark -INFO -Spark object created.....
2024-02-24 09:22:31,809 - root -INFO -Spark object is created!
2024-02-24 09:22:31,809 - root -INFO -Validating spark object
2024-02-24 09:22:31,809 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:22:35,719 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:22:35,719 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:22:35,719 - Ingest -WARNING -load_files method started
2024-02-24 09:22:35,780 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:22:38,936 - root -INFO -The app done
2024-02-24 09:23:43,303 - root -INFO -calling spark object
2024-02-24 09:23:43,304 - Create_spark -INFO -master is local[*]
2024-02-24 09:23:47,992 - Create_spark -INFO -Spark object created.....
2024-02-24 09:23:47,992 - root -INFO -Spark object is created!
2024-02-24 09:23:47,992 - root -INFO -Validating spark object
2024-02-24 09:23:47,992 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:23:51,727 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:23:51,727 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:23:51,728 - Ingest -WARNING -load_files method started
2024-02-24 09:23:51,798 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:23:55,070 - root -INFO -The app done
2024-02-24 09:34:44,232 - root -INFO -calling spark object
2024-02-24 09:34:44,232 - Create_spark -INFO -master is local[*]
2024-02-24 09:34:52,016 - Create_spark -INFO -Spark object created.....
2024-02-24 09:34:52,016 - root -INFO -Spark object is created!
2024-02-24 09:34:52,016 - root -INFO -Validating spark object
2024-02-24 09:34:52,016 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:34:56,915 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:34:56,916 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:34:56,916 - Ingest -WARNING -load_files method started
2024-02-24 09:34:57,008 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:35:00,010 - Ingest -WARNING -load_files method started
2024-02-24 09:35:00,061 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:35:02,532 - root -INFO -The app done
2024-02-24 09:39:33,827 - root -INFO -calling spark object
2024-02-24 09:39:33,827 - Create_spark -INFO -master is local[*]
2024-02-24 09:39:38,375 - Create_spark -INFO -Spark object created.....
2024-02-24 09:39:38,375 - root -INFO -Spark object is created!
2024-02-24 09:39:38,375 - root -INFO -Validating spark object
2024-02-24 09:39:38,375 - Validate -WARNING -started the get_current_date method...
2024-02-24 09:39:42,124 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 09:39:42,124 - Validate -WARNING -Validation done , go frwd...
2024-02-24 09:39:42,124 - Ingest -WARNING -load_files method started
2024-02-24 09:39:42,196 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:39:44,610 - Ingest -WARNING -load_files method started
2024-02-24 09:39:44,633 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 09:39:46,939 - root -INFO -The app done
2024-02-24 10:41:28,683 - root -INFO -calling spark object
2024-02-24 10:41:28,684 - Create_spark -INFO -master is local[*]
2024-02-24 10:41:37,084 - Create_spark -INFO -Spark object created.....
2024-02-24 10:41:37,084 - root -INFO -Spark object is created!
2024-02-24 10:41:37,085 - root -INFO -Validating spark object
2024-02-24 10:41:37,085 - Validate -WARNING -started the get_current_date method...
2024-02-24 10:41:42,608 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 10:41:42,608 - Validate -WARNING -Validation done , go frwd...
2024-02-24 10:41:42,608 - Ingest -WARNING -load_files method started
2024-02-24 10:41:42,700 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 10:42:19,129 - Ingest -WARNING -load_files method started
2024-02-24 10:42:19,168 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 10:42:50,698 - root -INFO -The app done
2024-02-24 10:45:03,611 - root -INFO -calling spark object
2024-02-24 10:45:03,611 - Create_spark -INFO -master is local[*]
2024-02-24 10:45:09,874 - Create_spark -INFO -Spark object created.....
2024-02-24 10:45:09,874 - root -INFO -Spark object is created!
2024-02-24 10:45:09,874 - root -INFO -Validating spark object
2024-02-24 10:45:09,874 - Validate -WARNING -started the get_current_date method...
2024-02-24 10:45:14,630 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 10:45:14,632 - Validate -WARNING -Validation done , go frwd...
2024-02-24 10:45:14,632 - Ingest -WARNING -load_files method started
2024-02-24 10:45:14,725 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 10:45:18,003 - Ingest -WARNING -load_files method started
2024-02-24 10:45:18,041 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 10:45:52,369 - root -INFO -The app done
2024-02-24 10:48:48,895 - root -INFO -calling spark object
2024-02-24 10:48:48,896 - Create_spark -INFO -master is local[*]
2024-02-24 10:48:55,774 - Create_spark -INFO -Spark object created.....
2024-02-24 10:48:55,774 - root -INFO -Spark object is created!
2024-02-24 10:48:55,774 - root -INFO -Validating spark object
2024-02-24 10:48:55,775 - Validate -WARNING -started the get_current_date method...
2024-02-24 10:49:00,504 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 10:49:00,504 - Validate -WARNING -Validation done , go frwd...
2024-02-24 10:49:00,504 - Ingest -WARNING -load_files method started
2024-02-24 10:49:00,585 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 10:49:04,131 - Ingest -WARNING -load_files method started
2024-02-24 10:49:04,170 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 10:49:36,398 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 10:49:36,398 - root -INFO -The app done
2024-02-24 15:17:30,515 - root -INFO -calling spark object
2024-02-24 15:17:30,516 - Create_spark -INFO -master is local[*]
2024-02-24 15:17:38,806 - Create_spark -INFO -Spark object created.....
2024-02-24 15:17:38,806 - root -INFO -Spark object is created!
2024-02-24 15:17:38,806 - root -INFO -Validating spark object
2024-02-24 15:17:38,808 - Validate -WARNING -started the get_current_date method...
2024-02-24 15:17:44,861 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 15:17:44,862 - Validate -WARNING -Validation done , go frwd...
2024-02-24 15:17:44,862 - Ingest -WARNING -load_files method started
2024-02-24 15:17:44,927 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:17:50,904 - Ingest -WARNING -load_files method started
2024-02-24 15:17:50,931 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:18:17,830 - root -ERROR -Exception while sending command.
Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=912>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-24 15:18:17,836 - root -ERROR -Exception while sending command.
Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o19.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\Code\PysparkPro\.venv\Lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-02-24 15:18:18,368 - root -INFO -The app done
2024-02-24 15:18:41,924 - root -INFO -calling spark object
2024-02-24 15:18:41,953 - Create_spark -INFO -master is local[*]
2024-02-24 15:19:10,329 - Create_spark -INFO -Spark object created.....
2024-02-24 15:19:10,329 - root -INFO -Spark object is created!
2024-02-24 15:19:10,330 - root -INFO -Validating spark object
2024-02-24 15:19:10,330 - Validate -WARNING -started the get_current_date method...
2024-02-24 15:19:30,802 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 15:19:30,802 - Validate -WARNING -Validation done , go frwd...
2024-02-24 15:19:30,803 - Ingest -WARNING -load_files method started
2024-02-24 15:19:31,382 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:19:38,201 - Ingest -WARNING -load_files method started
2024-02-24 15:19:38,228 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:20:15,274 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 15:20:15,275 - root -INFO -The app done
2024-02-24 15:20:47,920 - root -INFO -calling spark object
2024-02-24 15:20:47,921 - Create_spark -INFO -master is local[*]
2024-02-24 15:20:55,770 - Create_spark -INFO -Spark object created.....
2024-02-24 15:20:55,770 - root -INFO -Spark object is created!
2024-02-24 15:20:55,770 - root -INFO -Validating spark object
2024-02-24 15:20:55,770 - Validate -WARNING -started the get_current_date method...
2024-02-24 15:21:03,963 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 15:21:03,964 - Validate -WARNING -Validation done , go frwd...
2024-02-24 15:21:03,964 - Ingest -WARNING -load_files method started
2024-02-24 15:21:04,050 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:21:09,390 - Ingest -WARNING -load_files method started
2024-02-24 15:21:09,426 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:21:49,947 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 15:21:49,947 - root -INFO -The app done
2024-02-24 15:22:31,412 - root -INFO -calling spark object
2024-02-24 15:22:31,412 - Create_spark -INFO -master is local[*]
2024-02-24 15:22:41,875 - Create_spark -INFO -Spark object created.....
2024-02-24 15:22:41,875 - root -INFO -Spark object is created!
2024-02-24 15:22:41,875 - root -INFO -Validating spark object
2024-02-24 15:22:41,875 - Validate -WARNING -started the get_current_date method...
2024-02-24 15:22:50,537 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 15:22:50,537 - Validate -WARNING -Validation done , go frwd...
2024-02-24 15:22:50,537 - Ingest -WARNING -load_files method started
2024-02-24 15:22:51,154 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:22:56,263 - Ingest -WARNING -load_files method started
2024-02-24 15:22:56,316 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 15:23:48,764 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 15:23:48,764 - root -INFO -The app done
2024-02-24 16:12:18,345 - root -INFO -calling spark object
2024-02-24 16:12:18,346 - Create_spark -INFO -master is local[*]
2024-02-24 16:14:24,270 - root -INFO -calling spark object
2024-02-24 16:14:24,271 - Create_spark -INFO -master is local[*]
2024-02-24 16:14:32,422 - Create_spark -INFO -Spark object created.....
2024-02-24 16:14:32,423 - root -INFO -Spark object is created!
2024-02-24 16:14:32,423 - root -INFO -Validating spark object
2024-02-24 16:14:32,423 - Validate -WARNING -started the get_current_date method...
2024-02-24 16:14:38,530 - Validate -WARNING -validating spark object with current date-[Row(current_date()=datetime.date(2024, 2, 24))]
2024-02-24 16:14:38,530 - Validate -WARNING -Validation done , go frwd...
2024-02-24 16:14:38,530 - Ingest -WARNING -load_files method started
2024-02-24 16:14:38,615 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 16:14:42,306 - Ingest -WARNING -load_files method started
2024-02-24 16:14:42,353 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 16:15:33,421 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 16:15:33,421 - root -INFO -Get file info from olap src
2024-02-24 16:15:33,421 - root -INFO -reading file which is of > parquet
2024-02-24 16:15:33,421 - root -INFO -Load the cities data
2024-02-24 16:15:33,421 - Ingest -WARNING -load_files method started
2024-02-24 16:15:34,174 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 16:15:35,798 - root -INFO -Number of records of city table is 28338 
2024-02-24 16:15:35,798 - root -INFO -Get the file info from oltp src
2024-02-24 16:15:35,798 - root -INFO -reading file which is of > csv
2024-02-24 16:15:35,798 - root -INFO -Load the presc medicare data
2024-02-24 16:15:35,798 - Ingest -WARNING -load_files method started
2024-02-24 16:15:38,998 - Ingest -WARNING -Load_files func done, go fwd..
2024-02-24 16:15:39,954 - root -INFO -Number of records of Presc_medicare table is 1329329 
2024-02-24 16:15:39,956 - root -INFO -Count the null value in the presc dataset! 
2024-02-24 16:15:39,956 - Validate -INFO -check for nulls method executing.......for df_sel
2024-02-24 16:15:40,408 - Validate -WARNING -Check_for_nulls executed successfully...
2024-02-24 16:15:48,148 - root -INFO -Cleaning the two dataframe!
2024-02-24 16:15:48,148 - Data_processing -WARNING -data_clean method() started...
2024-02-24 16:15:48,148 - Data_processing -WARNING -selecting required columns and converting some of columns into upper case..
2024-02-24 16:15:48,176 - Data_processing -WARNING -working on OLTP dataset and selecting couple of columns and rename...
2024-02-24 16:15:48,196 - Data_processing -WARNING -Adding a new column to df_presc_sel
2024-02-24 16:15:48,206 - Data_processing -WARNING -converting Year_of_exp string to Int and replacing = 
2024-02-24 16:15:48,268 - Data_processing -WARNING -concat first and last name 
2024-02-24 16:15:48,286 - Data_processing -WARNING -now dropping presc_lname and presc_fname
2024-02-24 16:15:48,296 - Data_processing -WARNING -now check for null values in all columns
2024-02-24 16:15:48,297 - Data_processing -WARNING -drop the null values in the respective columns....
2024-02-24 16:15:48,317 - Data_processing -WARNING -fill the null values in tx_cnt with the avg values...
2024-02-24 16:15:49,696 - Data_processing -WARNING -successfully droped the null values....
2024-02-24 16:15:49,696 - Data_processing -WARNING -check for the null values cleaned are not ....
2024-02-24 16:15:49,696 - Data_processing -WARNING -data_clean() method executed done, go frwd....
2024-02-24 16:15:50,097 - Validate -WARNING -print schema method executing....df_presc_sel 
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('presc_id', StringType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('presc_city', StringType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('presc_state', StringType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('presc_spclt', StringType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('drug_name', StringType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('tx_cnt', IntegerType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('total_day_supply', IntegerType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('total_drug_cost', DoubleType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('years_of_exp', IntegerType(), True)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('Country_name', StringType(), False)
2024-02-24 16:15:50,099 - Validate -INFO -	StructField('presc_fullname', StringType(), False)
2024-02-24 16:15:50,099 - Validate -INFO -print_schema done, go ....
2024-02-24 16:15:50,099 - Validate -WARNING -print schema method executing....df_city_sel 
2024-02-24 16:15:50,101 - Validate -INFO -	StructField('city', StringType(), True)
2024-02-24 16:15:50,101 - Validate -INFO -	StructField('state_id', StringType(), True)
2024-02-24 16:15:50,101 - Validate -INFO -	StructField('state_name', StringType(), True)
2024-02-24 16:15:50,101 - Validate -INFO -	StructField('county_name', StringType(), True)
2024-02-24 16:15:50,101 - Validate -INFO -	StructField('population', IntegerType(), True)
2024-02-24 16:15:50,101 - Validate -INFO -	StructField('zips', StringType(), True)
2024-02-24 16:15:50,101 - Validate -INFO -print_schema done, go ....
2024-02-24 16:15:50,102 - root -INFO -Showing the report 1!
2024-02-24 16:15:50,102 - Data_transformation -WARNING -processing the data_report1 about them presc by the city  ..
2024-02-24 16:15:50,103 - Data_transformation -WARNING -calculating total zip counts in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-02-24 16:15:50,147 - Data_transformation -WARNING -calculating distinct prescribers and total tx_cnt
2024-02-24 16:15:50,203 - Data_transformation -WARNING -Don't report a city if no prescriber is assigned to it.....lets join df_city_sel and df_presc_grp
2024-02-24 16:15:50,266 - Data_transformation -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 16:15:58,474 - root -INFO -Showing the report 2!
2024-02-24 16:15:58,474 - Data_transformation -WARNING -executing data_report about the prescriber who has more than 20 yoe and less than 50 yoe and rank top 5 base on their tx_cnt for each state
2024-02-24 16:15:58,636 - Data_transformation -WARNING -data_report2 method executed...., go
2024-02-24 16:16:02,787 - root -INFO -Loadin to the postgresQl
2024-02-24 16:16:06,118 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 16:16:11,817 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 16:16:12,600 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 16:16:21,718 - Load_postgresql -WARNING -Data_report1 succesfully executed..., go frwd
2024-02-24 16:16:21,718 - root -INFO -The app done
2024-02-26 16:09:26,168 - root -INFO -calling spark object
2024-02-26 16:09:26,168 - Create_spark -INFO -master is local[*]
2024-02-26 16:09:26,213 - root -INFO -The app done
